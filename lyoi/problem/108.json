{"title":"「AHOI2009」维护序列","time_limit":1000,"memory_limit":256,"tags":[],"operation":{"submit":"https://lyoi.cc/problem/108#submit_code","submissions":"https://lyoi.cc/submissions?problem_id=108","statistics":"https://lyoi.cc/problem/108/statistics/fastest","testdata":"https://lyoi.cc/problem/108/testdata","discussion":"https://lyoi.cc/discussion/problem/108"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"Sengxian 交给 Menci  一个维护数列的任务，现在 Menci 希望你来帮他完成。\r\n\r\n有长为 $ n $ 的数列，不妨设为 $ \\{ a_1, a_2, \\ldots, a_n \\} $。有如下三种操作形式： \r\n\r\n1. 把数列中的一段数全部乘一个值；\r\n2. 把数列中的一段数全部加一个值；\r\n3. 询问数列中的一段数的和，由于答案可能很大，你只需输出这个数模 $ p $ 的值。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行两个整数 $ n $ 和 $ p $（$ 1 \\leq p \\leq 10 ^ 9 $）。  \r\n第二行含有 $ n $ 个非负整数，从左到右依次为 $ \\{ a_1, a_2, \\ldots, a_n \\} $，（$ 0 \\leq a_i \\leq 10 ^ 9 $）。  \r\n第三行有一个整数 $ m $，表示操作总数。  \r\n从第四行开始每行描述一个操作，输入的操作有以下三种形式：\r\n\r\n1. `1 t g c`，表示把所有满足 $ t \\leq i \\leq g $ 的 $ a_i $ 改为 $ a_i \\times c $（$ 1 \\leq t \\leq g \\leq n, 0 \\leq c \\leq 10 ^ 9 $）；\r\n2. `2 t g c`，表示把所有满足 $ t \\leq i \\leq g $ 的 $ a_i $ 改为 $ a_i + c $（$ 1 \\leq t \\leq g \\leq n, 0 \\leq c \\leq 10 ^ 9 $）；\r\n3. `3 t g`，询问所有满足 $ t \\leq i \\leq g $ 的 $ a_i $ 的和模 $ p $ 的值（$ 1 \\leq t \\leq g \\leq n $)。\r\n\r\n同一行相邻两数之间用一个空格隔开，每行开头和末尾没有多余空格。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"对每个操作 3，按照它在输入中出现的顺序，依次输出一行一个整数表示询问结果。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入\r\n```plain\r\n7 43\r\n1 2 3 4 5 6 7\r\n5\r\n1 2 5 5\r\n3 2 4\r\n2 3 7 9\r\n3 1 3\r\n3 4 7\r\n```\r\n\r\n#### 样例输出\r\n```plain\r\n2\r\n35\r\n8\r\n```\r\n\r\n#### 样例解释\r\n初始时数列为 $ \\{ 1, 2, 3, 4, 5, 6, 7 \\} $；  \r\n经过第 1 次操作后，数列为 $ \\{ 1, 10, 15, 20, 25, 6, 7 \\} $；  \r\n对第 2 次操作，和为 $ 10 + 15 + 20 = 45 $，模 $ 43 $ 的结果是 $ 2 $；  \r\n经过第 3 次操作后，数列为 $ \\{ 1, 10, 24, 29, 34, 15, 16 \\} $；  \r\n对第 4 次操作，和为 $ 1 + 10 + 24 = 35 $，模 $ 43 $ 的结果是 $ 35 $；  \r\n对第 5 次操作，和为 $ 29 + 34 + 15 + 16 = 94 $，模 $ 43 $ 的结果是 $ 8 $。"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"$ 1 \\leq n, m \\leq 10 ^ 5 $"}]}