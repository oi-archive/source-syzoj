{"title":"「LYOI2016 Summer」Cross","time_limit":2000,"memory_limit":1024,"tags":[],"operation":{"submit":"https://lyoi.cc/problem/38#submit_code","submissions":"https://lyoi.cc/submissions?problem_id=38","statistics":"https://lyoi.cc/problem/38/statistics/fastest","testdata":"https://lyoi.cc/problem/38/testdata","discussion":"https://lyoi.cc/discussion/problem/38"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"CYR 在打游戏，他需要穿过一些密室，最终到达终点。游戏开始时，他会首先走进 $ 1 $ 号密室，最后他需要走入 $ n $ 号密室。\r\n\r\n这些密室之间由一些长度不同无向边相连。有些密室中有陷阱，在 CYR 进入这些密室时，CYR 会死亡。死亡后，CYR 可以复活在死亡时进入的密室中。\r\n\r\n因为某不愿透漏姓名的 Edge 同学使用了修改器，游戏复活前需要较长的等待时间，所以在老师来机房之前，CYR 只有 $ k $ 次复活的机会。CYR 想知道他能不能顺利打完这局游戏，如果能，请告诉他在游戏中最少要走多远。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行三个正整数 $ n $、$ m $、$ k $，分别密室数、边数和复活次数。\r\n\r\n之后的 $ n $ 行，第 $ i $ 行一个数 $ 0 $ 或 $ 1 $，$ 0 $ 表示该密室没有陷阱，$ 1 $ 表示该密室有陷阱。\r\n\r\n之后的 $ m $ 行，每行三个正整数 $ u $、$ v $、$ w $，表示从 $ u $ 号密室到 $ v $ 号密室有一条长度为 $ w $ 的无向边。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"一行一个正整数，如果 CYR 能顺利完成游戏，输出他在游戏中最少要走多远，否则输出 $ -1 $。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 输入样例\r\n```plain\r\n4 5 1\r\n1\r\n0\r\n1\r\n0\r\n1 2 10\r\n2 3 10\r\n3 1 15\r\n1 4 60\r\n3 4 30\r\n```\r\n\r\n#### 输出样例\r\n```plain\r\n60\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于 $ 30\\% $ 的数据，$ n, m, k \\leq 10 $；  \r\n对于另外 $ 20\\% $ 的数据，$ k = 0 $；  \r\n对于另外 $ 20\\% $ 的数据，$ k = 1 $；  \r\n对于 $ 100\\% $ 的数据，$ 1 \\leq n \\leq 800 $，$ 1 \\leq m \\leq 4000 $，$ 1 \\leq k \\leq 10 $，$ 1 \\leq w \\leq 10 ^ 6 $；  \r\n保证没有重边和自环。"}]}