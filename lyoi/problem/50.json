{"title":"「LYOI2016 Summer」试制 51cm 连装炮","time_limit":1000,"memory_limit":128,"tags":[],"operation":{"submit":"https://lyoi.cc/problem/50#submit_code","submissions":"https://lyoi.cc/submissions?problem_id=50","statistics":"https://lyoi.cc/problem/50/statistics/fastest","testdata":"https://lyoi.cc/problem/50/testdata","discussion":"https://lyoi.cc/discussion/problem/50"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"⑨bishi 有一个和平而安定的村庄。邪恶的 12dora 好像正在蓄谋一个大计划 ……  \r\n⑨bishi 的村庄呈一个矩形，大小为 $ n \\times m $，每个单位格子上都是道路、房屋、田地三者其中一个，三者的耐久度分别为 $ a $、$ b $、$ c $ 点。  \r\n邪恶的 12dora 拥有两个试制 51cm 连装炮，他想要用它来摧毁 ⑨bishi 的村庄！\r\n\r\n⑨bishi 知道 12dora 的两个试制 51cm 连装炮的特点：一种有溅射伤害（溅射伤害定义为：若对某一个方格有非溅射伤害，将对此方格周围八个方格有伤害为 $ w $ 的溅射伤害。）编号为 $ 0 $，一种没有，编号为 $ 1 $。这两种的攻击范围是 $ k \\times k $  的矩阵（$ k $ 为奇数），每次攻击对这个矩阵每一个格子的伤害不一定相同。村长 ⑨bishi 已经得知 12dora 的发弹顺序、坐标以及所用的试制 51cm 连装炮的种类，他想知道如果他的村庄遭到打击，将会有多少村庄、房屋、田地被毁（被毁的定义是耐久度为 $ 0 $，耐久度最小为 $ 0 $）和所损失的总耐久度为多少，但他的村庄实在太大了，他真的懒得手算，于是他把所有他所知道的信息交给学 OI 的你，希望你能帮助他解决问题。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行两个数 $ n,m $，表示 ⑨bishi 的村庄大小。  \r\n下一行三个数 $ a,b,c $，表示一个格子上道路、房屋、田地的耐久度。接下来一个数 $ k,w $，表示 12dora 的试制 51cm 连装炮的攻击范围以及溅射伤害。  \r\n接下来 $ k $ 行，每行 $ k $ 个数，表示 12dora 的试制 51cm 连装炮攻击范围中，对相对位置所造成的伤害。  \r\n接下来一个 $ n \\times m $ 的矩阵，表示 ⑨bishi 的村庄的布局。 $ 1 $ 表示道路，$ 2 $ 表示房屋，$ 3 $ 表示田地。  \r\n接下来一个数 $ q $，表示 12dora 要进行 $ q $ 轮攻击。  \r\n接下来 $ q $ 行，每行三个数，分别为 12dora 使用的试制 51cm 连装炮的种类的编号以及他所攻击的矩阵的中心位置的 $ x $ 坐标、$ y $ 坐标。  "},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"第一行三个数，为村庄、房屋、田地各自被完全摧毁的数量。  \r\n第二行一个数，表示被摧毁的耐久度总和。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 输入样例\r\n```plain\r\n3 3\r\n1 1 1\r\n3 1\r\n1 1 1\r\n1 1 1\r\n1 1 1\r\n1 1 1\r\n1 1 1\r\n1 1 1\r\n1\r\n1 2 2\r\n```\r\n\r\n#### 输出样例\r\n```plain\r\n9 0 0\r\n9\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于 $ 30\\% $ 的数据，$ 1 \\leq n,m,k,q \\leq 50 $  ；  \r\n对于 $ 100\\% $ 的数据，$ 1 \\leq n,m,k,q \\leq 300,1 \\leq a,b,c,w \\leq 1000000000 $。"}]}