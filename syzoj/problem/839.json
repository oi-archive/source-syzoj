{"title":"「联合省选 2020 A」组合数问题","time_limit":1000,"memory_limit":512,"tags":[],"operation":{"submit":"https://syzoj.com/problem/839#submit_code","submissions":"https://syzoj.com/submissions?problem_id=839","statistics":"https://syzoj.com/problem/839/statistics/fastest","testdata":"https://syzoj.com/problem/839/testdata","discussion":"https://syzoj.com/discussion/problem/839"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"众所周知，小葱同学擅长计算，尤其擅长计算组合数。小葱现在希望你计算\r\n\r\n$$\r\n\\left(\\sum_{k=0}^n f(k) \\times x^k \\times \\binom n k\\right) \\bmod p\r\n$$\r\n\r\n的值。其中 $n, x, p$ 为给定的整数，$f(k)$ 为给定的一个 $m$ 次多项式 $f(k) = a_0 + a_1 k + a_2 k^2 + \\cdots + a_m k^m$。\r\n\r\n$\\binom n k$ 为组合数，其值为 $\\binom n k = \\frac{n!}{k!(n-k)!}$。\r\n"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行四个非负整数 $n, x, p, m$。\r\n第二行 $m + 1$ 个整数，分别代表 $a_0, a_1, \\dots, a_m$。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"仅一行一个整数表示答案。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入 1\r\n\r\n```plain\r\n5 1 10007 2\r\n0 0 1\r\n```\r\n\r\n#### 样例输出 1\r\n\r\n```plain\r\n240\r\n```\r\n\r\n#### 样例解释 1\r\n\r\n$f(0) = 0，f(1) = 1，f(2) = 4，f(3) = 9，f(4) = 16，f(5) = 25$。\r\n\r\n$x = 1$，故 $x^k$ 恒为 $1$，乘积中的该项可以忽略。\r\n\r\n$\\binom 5 0 = 1, \\binom 5 1 = 5, \\binom 5 2 = 10, \\binom 5 3 = 10, \\binom 5 4 = 5, \\binom 5 5 = 1$。\r\n\r\n最终答案为：\r\n\r\n$$\r\n\\sum_{k=0}^5 f(5) \\times \\binom 5 k = 0\\times 1 + 1\\times 5 + 4\\times 10 + 9\\times 10 + 16\\times 5 + 25\\times 1 = 240\r\n$$\r\n\r\n#### 样例输入 2\r\n\r\n```plain\r\n996 233 998244353 5\r\n5 4 13 16 20 15\r\n```\r\n\r\n#### 样例输出 2\r\n\r\n```plain\r\n869469289\r\n```\r\n\r\n#### 样例 3\r\n\r\n见附加文件中 `problem3.in` 与 `problem3.ans`。\r\n\r\n"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于所有测试数据：$1\\le n, x, p \\le 10^9, 0\\le a_i\\le 10^9, 0\\le m \\le \\min(n,1000)$。\r\n\r\n每个测试点的具体限制见下表：\r\n\r\n| 测试点编号  | $n\\le $ | $m\\le $ | 其他特殊限制 |\r\n| :---------: | :-----: | :-----: | :----------: |\r\n|  $1\\sim 3$  | $1000$  | $1000$  |              |\r\n|  $4\\sim 6$  | $10^5$  |   $0$   |  $p$ 是质数  |\r\n|  $7\\sim 8$  | $10^9$  |   $0$   |              |\r\n| $9\\sim 12$  | $10^9$  |   $5$   |              |\r\n| $13\\sim 16$ | $10^9$  | $1000$  |    $x=1$     |\r\n| $17\\sim 20$ | $10^9$  | $1000$  |              |\r\n\r\n"}]}