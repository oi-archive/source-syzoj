{"title":"字胡串","time_limit":1000,"memory_limit":512,"tags":[],"operation":{"submit":"https://syzoj.com/problem/619#submit_code","submissions":"https://syzoj.com/submissions?problem_id=619","statistics":"https://syzoj.com/problem/619/statistics/fastest","testdata":"https://syzoj.com/problem/619/testdata","discussion":"https://syzoj.com/discussion/problem/619"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"小 Z 最近喜欢上了字胡串。字胡串是一个由数字拼接而成的序列。具体的，用 $S$ 来表示一个字胡串，$S_{i}$ 表示这个字胡串的第 $i$ 位，$S_{l,r}(1 ≤ l ≤ r ≤ n)$ 表示这个字胡串的一个子串，这个子串是由 $S_{l}, S_{l+1}, ..., S_{r}$ 依次拼接而成的一个字胡串。\r\n小 Z 自己定义了一个函数 $f (S)$，其中：\r\n\r\n$$\r\n\\begin{split}\r\nf(S) =max_{i=1}^{n} Si\r\n\\end{split}\r\n$$\r\n\r\n他还定义了一个函数 $g(S)$，其中：\r\n$$\r\n\\begin{split}\r\ng(S) = S_{1}  \\mid S_{2} \\mid ... \\mid S_{n}\r\n\\end{split}\r\n$$\r\n现在小 Z 想要问你，对于给定的字胡串 $S$，有多少个子串 $T$ ，满足 $g(T ) > f (T )$。\r\n"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行一个整数 $n$。\r\n接下来一行 $n$ 个整数，第 $i$ 个数表示 $S_{i}$。\r\n"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"输出一个数，表示满足条件的子串的个数。\r\n"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"sample input 1\r\n```\r\n5\r\n3 2 1 6 5\r\n```\r\nsample output 1\r\n```\r\n8\r\n```\r\nsample input 2\r\n```\r\n4\r\n3 3 3 3\r\n```\r\nsample output 2\r\n```\r\n0\r\n```\r\n"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于 $20 %$ 的数据，$n ≤ 300$。    \r\n对于 $50 %$ 的数据，$n ≤ 3000$。     \r\n对于 $80 %$ 的数据，$n ≤ 10^{5}$。    \r\n对于 $100 %$ 的数据，$n ≤ 10^{6}$，$ai ≤ 10^{9}$。     \r\n"}]}