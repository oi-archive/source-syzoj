{"title":"「一本通 5.2 练习 1」加分二叉树","time_limit":1000,"memory_limit":512,"tags":[],"operation":{"submit":"https://syzoj.com/problem/831#submit_code","submissions":"https://syzoj.com/submissions?problem_id=831","statistics":"https://syzoj.com/problem/831/statistics/fastest","testdata":"https://syzoj.com/problem/831/testdata","discussion":"https://syzoj.com/discussion/problem/831"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"**原题来自：NOIP 2003**\r\n\r\n设一个 $n$ 个节点的二叉树 $\\mathrm{tree}$ 的中序遍历为 $(1,2,3,\\cdots,n)$，其中数字 $1,2,3,\\cdots,n$ 为节点编号。每个节点都有一个分数（均为正整数），记第 $i$ 个节点的分数为 $d_i$，$\\mathrm{tree}$ 及它的每个子树都有一个加分，任一棵子树 $\\mathrm{subtree}$（也包含 $\\mathrm{tree}$ 本身）的加分计算方法如下：\r\n\r\n记 $\\mathrm{subtree}$ 的左子树加分为 $l$，右子树加分为 $r$，$\\mathrm{subtree}$ 的根的分数为 $a$，则 $\\mathrm{subtree}$ 的加分为：\r\n\r\n$$l\\times r+a$$\r\n\r\n若某个子树为空，规定其加分为 $1$，叶子的加分就是叶节点本身的分数。不考虑它的空子树。\r\n\r\n试求一棵符合中序遍历为 $(1,2,3,\\cdots,n)$ 且加分最高的二叉树 $\\mathrm{tree}$。\r\n\r\n要求输出：\r\n\r\n1. $\\mathrm{tree}$ 的最高加分；\r\n2. $\\mathrm{tree}$ 的前序遍历。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行一个整数 $n$ 表示节点个数；\r\n\r\n第二行 $n$ 个空格隔开的整数，表示各节点的分数。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"第一行一个整数，为最高加分 $b$；\r\n\r\n第二行 $n$ 个用空格隔开的整数，为该树的前序遍历。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入\r\n```plain\r\n5\r\n5 7 1 2 10\r\n```\r\n#### 样例输出\r\n```plain\r\n145\r\n3 1 2 4 5\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于 $100\\%$ 的数据，$n\\lt 30,b\\lt 100$，结果不超过 $4\\times 10^9$。"}]}