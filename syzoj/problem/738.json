{"title":"「BJOI2018」求和","time_limit":2000,"memory_limit":512,"tags":["前缀和","最近公共祖先","图论"],"operation":{"submit":"https://syzoj.com/problem/738#submit_code","submissions":"https://syzoj.com/submissions?problem_id=738","statistics":"https://syzoj.com/problem/738/statistics/fastest","testdata":"https://syzoj.com/problem/738/testdata","discussion":"https://syzoj.com/discussion/problem/738"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"master 对树上的求和非常感兴趣。他生成了一棵有根树，并且希望多次询问这棵树上一段路径上所有节点深度的 $k$ 次方和，而且每次的 $k$ 可能是不同的。此处节点深度的定义是这个节点到根的路径上的边数。\r\n他把这个问题交给了 pupil，但 pupil 并不会这么复杂的操作，你能帮他解决吗？"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行包含一个正整数 $n$，表示树的节点数。\r\n\r\n之后 $n-1$ 行每行两个空格隔开的正整数 $i,j$，表示树上的一条连接点 $i$ 和点 $j$ 的边。\r\n\r\n之后一行一个正整数 $m$，表示询问的数量。\r\n\r\n之后每行三个空格隔开的正整数 $i,j,k$，表示询问从点 $i$ 到点 $j$ 的路径上所有节点深度的 $k$ 次方和。由于这个结果可能非常大，输出其对 $998244353$ 取模的结果。\r\n\r\n树的节点从 $1$ 开始标号，其中 $1$ 号节点为树的根。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"对于每组数据输出一行一个正整数表示取模后的结果。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入\r\n```plain\r\n5\r\n1 2\r\n1 3\r\n2 4\r\n2 5\r\n2\r\n1 4 5\r\n5 4 45\r\n```\r\n\r\n#### 样例输出\r\n```plain\r\n33\r\n503245989\r\n```\r\n#### 样例解释\r\n以下用 $d\\left(i\\right)$ 表示第 $i$ 个节点的深度。\r\n\r\n对于样例中的树，有 $d\\left(1\\right)=0,d\\left(2\\right)=1,d\\left(3\\right)=1,d\\left(4\\right)=2,d\\left(5\\right)=2$。\r\n\r\n因此第一个询问答案为 $\\left(2^5+1^5+0^5\\right) \\bmod 998244353=33$，第二个询问答案为 $\\left(2^{45}+1^{45}+2^{45}\\right) \\bmod 998244353=503245989$。\r\n"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于 $30\\%$ 的数据，$1 \\leq n,m \\leq 100$；\r\n\r\n对于 $60\\%$ 的数据，$1 \\leq n,m \\leq 1000$；\r\n\r\n对于 $100\\%$ 的数据，$1 \\leq n,m \\leq 300000,1 \\leq k \\leq 50$。"}]}