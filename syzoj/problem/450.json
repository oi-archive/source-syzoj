{"title":"小P的Civilization V","time_limit":2000,"memory_limit":512,"tags":["最近公共祖先","图论"],"operation":{"submit":"https://syzoj.com/problem/450#submit_code","submissions":"https://syzoj.com/submissions?problem_id=450","statistics":"https://syzoj.com/problem/450/statistics/fastest","testdata":"https://syzoj.com/problem/450/testdata","discussion":"https://syzoj.com/discussion/problem/450"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"小P最近在玩Civilization V，游戏的地图是一棵树，树的每个节点都可以当作战场，刚开始每个节点的战斗加成为$0$\r\n\r\n现在小P拥有两种人员：\r\n\r\n一种是工人，每个工人会有一个起点$u$和终点$v$，工人可以使$u->v$路径上每个节点的战斗加成$+1$\r\n\r\n一种是骑兵，每个骑兵也有一个起点$u$和终点$v$，骑兵可以选择$u->v$路径上任意节点战斗\r\n\r\n现有$m$个工人和$q$个骑兵，问每个骑兵作战最多可以拥有多少战斗加成\r\n"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行三个整数$n,m,q$\r\n\r\n接下来一行$n-1$个数，第$i$个数$f_i$表示第$i+1$个节点的父亲\r\n\r\n接下来$m$行，每行两个整数$u,v$，表示一个工人\r\n\r\n接下来$q$行，每行两个整数$u,v$，表示一个骑兵"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"$q$行，对于每个骑兵，输出他作战最多可以拥有多少战斗加成"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入1\r\n```\r\n5 5 5\r\n1 1 1 4 \r\n4 5\r\n4 1\r\n4 3\r\n5 3\r\n4 5\r\n1 3\r\n3 5\r\n1 1\r\n5 2\r\n4 2\r\n```\r\n#### 样例输出1\r\n```\r\n3\r\n5\r\n3\r\n5\r\n5\r\n```\r\n#### 样例输入2\r\n```\r\n9 5 5\r\n1 2 2 4 5 3 4 6 \r\n4 9\r\n4 7\r\n1 7\r\n1 2\r\n2 1\r\n9 9\r\n9 9\r\n3 3\r\n7 7\r\n2 2\r\n```\r\n#### 样例输出2\r\n```\r\n1\r\n1\r\n2\r\n2\r\n4\r\n```\r\n"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于$15\\%$的数据，保证$n,m,q\\le 1000$\r\n\r\n对于另外$15\\%$的数据，保证$f_i=i$\r\n\r\n对于另外$10\\%$的数据，保证所有$u=v$\r\n\r\n对于另外$10\\%$的数据，保证工人的$u=v$\r\n\r\n对于另外$10\\%$的数据，保证骑兵的$u=v$\r\n\r\n对于$100\\%$的数据，保证$n,m,q\\le 500,000$且$f_i\\le i$"}]}