{"title":"[NOI2015]软件包管理器 ","time_limit":1000,"memory_limit":128,"tags":["树链剖分"],"operation":{"submit":"https://syzoj.com/problem/223#submit_code","submissions":"https://syzoj.com/submissions?problem_id=223","statistics":"https://syzoj.com/problem/223/statistics/fastest","testdata":"https://syzoj.com/problem/223/testdata","discussion":"https://syzoj.com/discussion/problem/223"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"你决定设计你自己的软件包管理器。不可避免的，你要解决软件包之间的依赖关系。如果A依赖B，那么安装A之前需安装B，卸载B之前须卸载A。0号软件包不依赖任何软件包。依赖关系不存在环(包括自环)。 \r\n\r\n你的任务是，求出每次安装、删除操作会改变多少个包的状态。 \r\n\r\n安装一个已安装的软件包，或者卸载一个未安装的软件包，都不会改变任何软件包的安装状态，即在此情况下，改变安装状态的软件包数为0 \r\n\r\n每次操作不仅需要计算安装软件包数，还作为操作影响后来的安装/删除\r\n"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行一个整数n,表示软件包的总数。 \r\n\r\n随后n-1个整数a1,a2,...an−1，表示第i个软件包依赖第ai个软件包 \r\n\r\n接下来一行一个整数q,表示询问数 \r\n\r\n之后q行，每行一个询问，询问分为两种 \r\n\r\ninstall x：表示安装x \r\n\r\nuninstall x：表示卸载x \r\n"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"q行，每行一个整数，为第i步操作改变安装状态的软件包数"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#input\r\n```\r\n7 \r\n0 0 0 1 1 5 \r\n5 \r\ninstall 5 \r\ninstall 6 \r\nuninstall 1 \r\ninstall 4 \r\nuninstall 0 \r\n```\r\n\r\n#output\r\n```\r\n3 \r\n1 \r\n3 \r\n2 \r\n3 \r\n```\r\n![](http://cogs.sxysxy.org/upload/image/20150730/20150730170635_69367.png)\r\n\r\n一开始所有的软件包都处于未安装状态。\r\n安装5号软件包，需安装0,1,5三个软件包\r\n之后安装6号软件包，只需安装6号软件包。此时安装了0,1,5,6四个软件包。\r\n卸载1号软件包需要卸载1,5,6三个软件包，此时只有0号软件包还处于安装状态\r\n之后安装4号软件包，需安装1,4两个软件包。此时0,1,4处于安装状态\r\n最后，卸载0号软件包会卸载所有的软件包\r\n\r\n#input\r\n```\r\n10\r\n0 1 2 1 3 0 0 3 2\r\n10\r\ninstall 0\r\ninstall 3\r\nuninstall 2\r\ninstall 7\r\ninstall 5\r\ninstall 9\r\nuninstall 9\r\ninstall 4\r\ninstall 1\r\ninstall 9\r\n```\r\n\r\n#output\r\n```\r\n1\r\n3\r\n2\r\n1\r\n3\r\n1\r\n1\r\n1\r\n0\r\n1\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"1,2:n=5000 q=5000\r\n\r\n3,4:n=100000 q=100000 没有卸载操作\r\n\r\n5,6,7,8 n=100000,q=100000 依赖关系和操作随机\r\n\r\n9-20 n=100000,q=100000 不随机"}]}