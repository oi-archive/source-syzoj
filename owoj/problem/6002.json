{"title":"「GDKOI 2016 R1」魔卡少女","time_limit":1000,"memory_limit":256,"tags":["GDKOI","2016","线段树"],"operation":{"submit":"https://oj.akioi.ml:8200/problem/6002#submit_code","submissions":"https://oj.akioi.ml:8200/submissions?problem_id=6002","statistics":"https://oj.akioi.ml:8200/problem/6002/statistics/fastest","testdata":"https://oj.akioi.ml:8200/problem/6002/testdata","discussion":"https://oj.akioi.ml:8200/discussion/problem/6002"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"君君是中山大学的四年级学生。有一天在家不小心开启了放置在爸爸书房中的一本古书。于是，君君把放在书中最上面的一张牌拿出来观摩了一下，突然掀起一阵大风把书中的其她所有牌吹散到各地。这时一只看上去四不像的可爱生物「封印之兽」可鲁贝洛斯从书中钻了出来，它告诉君君书中的牌叫“库洛牌”，现在散落各地已实体化，要君君将它们全部再次封印起来，以免危害世界，于是君君开始过上了收服「库洛牌」的旅程。\r\n\r\n经过不懈努力，君君集齐了 $n$ 张库洛牌，最后的审判就要来临，为了战胜审判者月，君君开始研究起这 $n$ 张库洛牌的魔法效果。君君已经将 $n$ 张库洛牌从左到右依次排列好，这 $n$ 张库洛牌的魔法值从左到右依次为 $a_1,a_2,\\ldots,a_n$。她将告诉你这 $n$ 张库洛牌的魔法值。在最后的审判时，审判者月将会选择一个区间进行 PK，君君预测了可能进行 PK 的若干区间，她想请你帮助她计算这些区间的魔法效果，以便她更好地布置战术。一个区间内，所有连续子序列都会产生魔法效果。一个连续子序列 $p_1,p_2,\\ldots,p_k$ 的魔法效果定义为 $p_1\\oplus p_2\\oplus\\ldots\\oplus p_k$（$\\oplus$ 表示异或）。一个区间的魔法效果定义为所有连续子序列的魔法效果的和。例如有 $5$ 张库洛牌，魔法值为 $1,1,2,4,5$，询问区间 $[2,4]$ 的魔法效果。区间 $[2,4]$ 包含的连续子序列为 $1$，$2$，$4$，$1,2$，$2,4$，$1,2,4$, 它们的魔法值分别为 $1,2,4,3,6,7$，所以区间 $[2,4]$ 的魔法效果为 $1+2+4+3+6+7=23$。\r\n\r\n库洛牌的魔法效果狂拽炫酷吊炸天，这个值可能很大，所以你只需要输出这个值模 $\\color{red}{10^8+7}$。另外，任性的君君可以在询问的过程中对库洛牌的魔法值进行修改。\r\n\r\n现在，君君给出了 $m$ 个操作，操作格式如下：\r\n\r\n1. `M p x` 表示将第 $p$ 张库洛牌的魔法值修改为 $x$。\r\n2. `Q l r` 表示询问区间 $[l,r]$ 的魔法效果。\r\n\r\nPascal 语言中，异或操作符为 `xor`，C++ 语言中，异或操作符为 ` ̂`。\r\n\r\n---\r\n\r\nTL;DR：维护一个序列，支持单点修改，查询一个区间的所有子区间的异或和的和。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行为一个整数 $n$，表示有 $n$ 张库洛牌。\r\n\r\n第二行为 $n$ 个整数，表示一开始 $n$ 张库洛牌的值。\r\n\r\n第三行为一个整数 $m$，表示有 $m$ 个操作。\r\n\r\n接下来 $m$ 行，每行表示一个操作，格式如题目描述所示。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"对于每个操作 $2$，输出一行，每行一个数，表示询问的区间 $[l,r]$ 的魔法效果模 $\\color{red}{10^8+7}$。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入\r\n\r\n```plain\r\n5\r\n1 2 3 4 5\r\n7\r\nQ 1 3\r\nM 2 7\r\nQ 1 3\r\nM 2 2\r\nQ 1 3\r\nM 4 2\r\nQ 1 5\r\n```\r\n\r\n#### 样例输出\r\n\r\n```plain\r\n10\r\n26\r\n10\r\n47\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于 $30\\%$ 的数据：$1\\le n,m\\le300$。\r\n\r\n另外 $20\\%$ 的数据：$1\\le n,m\\le30000$，操作 $1$ 的数量不超过 $50$。\r\n\r\n对于 $80\\%$ 的数据：$1\\le n,m\\le30000$。\r\n\r\n对于 $100\\%$ 的数据：$1\\le n,m\\le100000,0\\le a_i,x\\le1000$。"}]}