{"title":"线段树","time_limit":3000,"memory_limit":256,"tags":[],"operation":{"submit":"https://oj.iqzsy.xyz/problem/409#submit_code","submissions":"https://oj.iqzsy.xyz/submissions?problem_id=409","statistics":"https://oj.iqzsy.xyz/problem/409/statistics/fastest","testdata":"https://oj.iqzsy.xyz/problem/409/testdata","discussion":"https://oj.iqzsy.xyz/discussion/problem/409"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"这是一道线段树经典题。\r\n\r\n你需要写一个数据结构（线段树）维护长度为 $ n ​$ 的三个序列 $ A,B,C ​$，下标为 $ 1\\sim n ​$，支持：\r\n\r\n- 对于 $ i\\in[l,r] $，令 $ A_i\\leftarrow\\min (A_i,x) $ 。\r\n\r\n- 对于 $ i\\in [l,r] $，令 $ A_i\\leftarrow A_i+x $。\r\n- 求 $ \\sum_{i=l}^r A_i ​$。\r\n- 求 $ \\sum_{i=l}^r B_i $。\r\n- 求 $ \\max_{i=l}^r C_i $。\r\n\r\n每次修改操作后（前两种操作），令 $ B_i\\leftarrow B_i+A_i,C_i\\leftarrow\\max(C_i,A_i) ​$。\r\n\r\n初始给定 $ A_i $，同时初始 $ B_i=0,C_i=A_i $。\r\n"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行两个正整数 $ n,Q $，分别表示序列长度和操作个数。\r\n\r\n第二行 $ n $ 个整数表示序列 $ A_i $。\r\n\r\n接下来 $ Q $ 行，每行第一个整数表示操作类型编号，其他数字意义同题面：\r\n\r\n- 若为类型 $ 1 ​$，接下来三个整数 $ l,r,x ​$。\r\n- 若为类型 $ 2 $，接下来三个整数 $ l,r,x $。\r\n- 若为类型 $ 3 ​$，接下来两个整数 $ l,r ​$。\r\n- 若为类型 $ 4 $，接下来两个整数 $ l,r $。\r\n- 若为类型 $ 5 $，接下来两个整数 $ l,r $。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"对于每个类型为 $ 3,4,5 ​$ 的操作，输出一行一个整数表示答案。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入 1\r\n\r\n``` plain \r\n10 10\r\n-3 -1 -1 2 -2 2 5 2 3 -3 \r\n2 2 6 2 \r\n4 5 8  \r\n5 6 9 \r\n1 6 7 -4 \r\n2 3 8 6\r\n3 4 5  \r\n5 1 3 \r\n1 5 7 -7 \r\n4 5 9 \r\n5 2 8\r\n```\r\n\r\n#### 样例输出 1\r\n\r\n``` plain\r\n11\r\n5\r\n16\r\n7\r\n22\r\n10\r\n```\r\n\r\n#### 样例输入 2\r\n\r\n``` plain \r\n10 10\r\n3 -5 -2 -2 3 -1 -1 3 -4 -4 \r\n4 5 8 \r\n2 1 10 -5 \r\n3 1 7 \r\n1 8 9 -3 \r\n5 1 10 \r\n3 7 10 \r\n2 2 4 -4 \r\n4 1 2 \r\n5 8 8 \r\n1 2 8 1 \r\n```\r\n\r\n#### 样例输出 2\r\n\r\n``` plain\r\n0\r\n-40\r\n3\r\n-27\r\n-40\r\n3\r\n```\r\n"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于 $ 100\\% $ 的数据，$ 1\\leq n,Q\\leq 2\\times 10^5,|a_i|\\leq 10^9 $，$1\\leq l\\leq r\\leq n$，数据保证过程中所有相关数值及输出的**绝对值**均在 `long long` 范围内。\r\n\r\n ~~数据均为随机，但没有梯度。~~"}]}