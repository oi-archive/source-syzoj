{"title":"「2019-03-10提高模拟赛」树统计(count)","time_limit":1000,"memory_limit":512,"tags":[],"operation":{"submit":"https://oj.iqzsy.xyz/problem/5253#submit_code","submissions":"https://oj.iqzsy.xyz/submissions?problem_id=5253","statistics":"https://oj.iqzsy.xyz/problem/5253/statistics/fastest","testdata":"https://oj.iqzsy.xyz/problem/5253/testdata","discussion":"https://oj.iqzsy.xyz/discussion/problem/5253"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"*<font face=\"楷体\"> 骗分过样例，暴力出奇迹。</font>*\r\n\r\n关于树的算法有一大堆，样样都是毒瘤。\r\n\r\n比如说 NOIP2018 提高组的 D2T3，如果会动态 DP 的做法那么就马上想到正解，但是 Tweetuzki 不会动态 DP，就只好骗分了。\r\n\r\n可惜树题的码量也是超级大的。听说好多学长都会动态 DP，但是考场上调不出来，只好暴力分收场了。~~疯狂暗示~~\r\n\r\nTweetuzki 当时暴力写挂了，有 4 个点写成了死循环……于是分数白白少了 16 分。Tweetuzki 一想起这事，不禁夙夜忧叹，辗转反侧。\r\n\r\n现在他又遇到一道毒瘤树上问题了，他下定决心：这次一定要把暴力分写满！\r\n\r\n题目是这样的：\r\n\r\n有一棵 $n$ 个点的树，边有边权，每个点有颜色 $c_i$。求所有颜色不同的点对的距离之和。由于答案可能很大，你只需要输出其对 $998,244,353$ 取模的结果即可。\r\n\r\n形式化地讲，记 $u$ 号点和 $v$ 号点在树上的距离为 $\\text{dist}(u, v)$，求：\r\n\r\n$$\r\n\\Large \\left(\\sum_{u = 1}^n \\sum_{v = 1}^n [c_u \\ne c_v] \\text{dist}(u, v)\\right) \\bmod 998,244,353\r\n$$"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"从文件 `count.in` 中读入。\r\n\r\n输入文件将会遵循以下格式：\r\n\r\n> $n \\quad \\text{type}$  \r\n> $c_1 \\quad c_2 \\quad \\cdots \\quad c_n$  \r\n> $u_1 \\quad v_1 \\quad w_1$  \r\n> $u_2 \\quad v_2 \\quad w_2$  \r\n> $\\vdots$  \r\n> $u_{n - 1} \\quad v_{n - 1} \\quad w_{n - 1}$\r\n\r\n第一行两个正整数 $n, \\text{type}$ $(2 \\le n \\le 2 \\times 10^5, 1 \\le \\text{type} \\le 6)$，其中 $n$ 表示点数，$\\text{type}$ 为部分分类型，详见数据范围，$\\text{type} = 0$ 表示样例数据。  \r\n第二行输入 $n$ 个正整数 $c_i$ $(1 \\le c_i \\le 10^9)$，表示每个点的颜色。  \r\n接下来 $n - 1$ 行，每行输入三个正整数 $u_i, v_i, w_i$ $(1 \\le u_i < v_i \\le n, 1 \\le w_i \\le 10^9)$，描述这棵树。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"输出到文件 `count.out` 中。\r\n\r\n输出一行一个非负整数，表示答案对 $998, 244, 353$ 取模的结果。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"**样例输入 1**\r\n\r\n```plain\r\n4 0\r\n1 2 3 3\r\n1 2 5\r\n2 3 4\r\n3 4 7\r\n```\r\n\r\n**样例输出 1**\r\n\r\n```plain\r\n90\r\n```\r\n\r\n**样例解释 1**\r\n\r\n满足条件的点对有 $(1, 2), (1, 3), (1, 4), (2, 1), (2, 3), (2, 4), (3, 1), (3, 2), (4, 1), (4, 2)$，故答案为 $5 + 9 + 16 + 5 + 4 + 11 + 9 + 4 + 16 + 11 = 90$。\r\n\r\n**样例输入 2**\r\n\r\n```plain\r\n8 0\r\n2 3 5 1 2 3 4 1\r\n1 2 12345\r\n1 3 234567\r\n1 5 3456\r\n2 4 4567890\r\n2 6 567\r\n3 7 67\r\n4 8 7\r\n```\r\n\r\n**样例输出 2**\r\n\r\n```plain\r\n115703306\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"**_Subtask_ #1 _(20 points)_**：$n \\le 300$, $\\text{type} = 1$。  \r\n**_Subtask_ #2 _(20 points)_**：$n \\le 2\\ 000$, $\\text{type} \\le 2$。  \r\n**_Subtask_ #3 _(10 points)_**：$n \\le 10\\ 000$, $\\text{type} \\le 3$。  \r\n**_Subtask_ #4 _(20 points)_**：对于第 $i$ $(1 \\le i \\le n)$ 号点，$c_i = i$。$\\text{type} = 4$。  \r\n**_Subtask_ #5 _(20 points)_**：对于第 $i$ $(1 \\le i < n)$ 条边，$u_i + 1 = v_i$。$\\text{type} = 5$。  \r\n**_Subtask_ #6 _(10 points)_**：无特殊性质，$\\text{type} \\le 6$。\r\n\r\n**提示：对于提高组选手而言，本题满分可视作 90 分。**"}]}