{"title":"「长乐国庆集训2018ROUND1」3. 历史","time_limit":1000,"memory_limit":256,"tags":[],"operation":{"submit":"https://oj.iqzsy.xyz/problem/5158#submit_code","submissions":"https://oj.iqzsy.xyz/submissions?problem_id=5158","statistics":"https://oj.iqzsy.xyz/problem/5158/statistics/fastest","testdata":"https://oj.iqzsy.xyz/problem/5158/testdata","discussion":"https://oj.iqzsy.xyz/discussion/problem/5158"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"历史学家dhh正在研究一个奇怪的王国的历史。当前阶段的任务是研究该国的交通。\r\n\n\r\n\n根据这个奇怪的王国的史书记载，史书开始记载前这个王国有 $n$ 个城市(城市从 $0$ 开始标号)，但所有城市之间都没有道路相连。\r\n\n\r\n\n每一年，在位的国王会修建一条双向道路 $x\\rightarrow y$，一条道路可能被修建多次。而在这之间，国王会计划进行若干次旅行。对于计划进行的一次旅行 $st\\rightarrow ed$，如果当时能完成这次旅行，而 $t$ 年前不能完成这次旅行，那么国王会对之前的建设成果感到满意，否则他会很生气，并在他感到满意之前（包括使他满意的那次旅行）都让史官记录下错误的信息，怎么样得到正确信息将在输入格式中描述。\r\n\n\r\n\n当然在这些年中也发生了若干次国王的交替，而每个国王的c值不一定相同，但在国王在位期间c值不会改变（初始国王的 $c$ 值为 $0$，其他的 $c$ 值可通过记载得到），新上位的国王开始处于不生气的状态。\r\n\n\r\n\n请根据史书帮助dhh得出国王每次对于计划旅行是否满意，从而使dhh能够研究该国的交通。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"多组数据，到EOF结束。\r\n\n\r\n\n每组数据第一行两个整数 $n,m$，表示初始城市数和史书记载的内容数。\r\n\n\r\n\n接下来m行，每行是以下三种格式之一：\r\n\n\r\n\n`K v`表示国王交替，如果被替换的国王是生气的（即这个是错误信息），那么新国王的 $c$ 值为 $v+$被替换的国王的c值，否则新国王的 $c$ 值为 $v$。\r\n\n\r\n\n`R x y`，表示史书上记载的是国王修建了 $x\\rightarrow y$ 的双向道路，如果这是错误信息，那么真实信息为修建 $(x+c) \\bmod n\\rightarrow (y+c) \\bmod n$ 的道路，否则为修建 $x \\bmod n\\rightarrow y \\bmod n$ 的道路。\r\n\n\r\n\n`T st ed t`，表示国王计划进行的一次 $st\\rightarrow ed$ 的旅行，且比较的是 $t$ 年前的情况（国王可能会和史书开始记载以前的情况比较），如果这是错误信息，那么真实信息为国王计划进行的一次 $(st+c) \\bmod n\\rightarrow (ed+c) \\bmod n$ 的旅行，且比较的是 $(t+c) \\bmod n$ 年前的情况，否则为一次 $st \\bmod n\\rightarrow ed \\bmod n$ 的旅行，且比较的是 $t \\bmod n$ 年前的情况。\r\n\n\r\n\n注意只有遇到`R`操作才会使年份的记数 $+1$。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"每组数据对于每个`T`的记录输出一行，如果此次旅行计划令国王满意，则输出`Y`，否则输出`N`。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"样例输入\r\n\r\n```\r\n3 7 \r\nR 0 1\r\nT 0 1 1 \r\nK 1 \r\nR 0 1 \r\nT 0 1 1\r\nR 0 1\r\nT 1 2 0\r\n```\r\n\r\n样例输出\r\n\r\n```\r\nY\r\nN\r\nY\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于 $30\\%$ 的数据，满足 $1\\le N\\le 1000，1\\le M\\le 10000$；\r\n\n\r\n\n对于 $100\\%$ 的数据，满足 $1\\le N,M\\le 3\\times 10^5，0\\le v,x,y,st,ed<N，0\\le t\\le m$。数据组数 $\\le 10$。"}]}