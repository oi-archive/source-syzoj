{"title":"「FJSC2018TGD7T3」宝藏","time_limit":2000,"memory_limit":512,"tags":["提高"],"operation":{"submit":"https://oj.iqzsy.xyz/problem/5076#submit_code","submissions":"https://oj.iqzsy.xyz/submissions?problem_id=5076","statistics":"https://oj.iqzsy.xyz/problem/5076/statistics/fastest","testdata":"https://oj.iqzsy.xyz/problem/5076/testdata","discussion":"https://oj.iqzsy.xyz/discussion/problem/5076"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"小E无意间得到了一张藏宝图。顺着藏宝图的指引，小E找到了藏宝洞的入口。\r\n\n\r\n\n根据藏宝图的描述，藏宝洞中共有$n$个洞穴和$m$条单向通道（单向是因为有一些玄妙的机关），通道有黑白之分，第i条通道由第$x_i$个洞穴通往第$y_i$个洞穴，颜色为$w_i$。通道可能形成重边或自环。藏宝洞的入口在第$1$个洞穴。\r\n\n\r\n\n入口处有一个石碑，石碑上记录了找到宝藏的方法。石碑上都是些难懂的话语，什么“秩序”“混沌”“周而复始”之类的，不过这难不倒小E，小E马上就破译了石碑给出的信息：\r\n\n\r\n\n黑白两种颜色可以分别看作$1$和$0$，用以下方式构造一个$01$串：初始串为一个$0$,进行无限多次操作，每次将当前串取反后得到的串接在当前串后，最终得到一个无限长的$01$串。例如，这个串的前几位分别为$0110100110010110$……\r\n\n\r\n\n从入口出发，第i步需要走一条与这个$01$串第$i$位相同颜色的通道，尽可能地走最多的步数后到达的洞穴既是宝藏所在之地。\r\n\n\r\n\n由于藏宝图可能出现破损信息错误或是宝藏本身就是假的，可能出现有多个合法的宝藏所在地或是要无限走下去的情况。小E现在只想知道，根据当前信息，她需要多少步才能找到一个合法的宝藏所在地。如果需要的步数超过${10}^{18}$,小E可能会弃疗。\r\n\n"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"从 `treasure.in` 读入数据\r\n\n\r\n\n第一行包含两个非负整数$n,m$。\r\n\n\r\n\n接下来$m$行，每行三个非负整数，分别表示$x_i,y_i,w_i$。\r\n\n"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"向 `treasure.out` 输出数据\r\n\n\r\n\n输出一个整数，表示答案，如果答案超过${10}^{18}$,输出$-1$。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"### 样例输入1\r\n``` plain\r\n2 2\r\n1 2 0\r\n2 2 1\r\n```\r\n### 样例输出1\r\n``` plain\r\n3\r\n```\r\n### 样例输入2\r\n``` plain\r\n2 3\r\n1 2 0\r\n2 2 0\r\n2 2 1\r\n```\r\n### 样例输出2\r\n``` plain\r\n-1\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于前$20\\%$的数据，答案不超过$10000$。\r\n\n\r\n\n对于前$60\\%$的数据，$n\\le100$。\r\n\n\r\n\n对于$100\\%$的数据，$1\\le n\\le500$,$0\\le m\\le2n^2$。\r\n\n"}]}