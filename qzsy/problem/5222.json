{"title":"「泉州基地校201811D4」2.挑战书","time_limit":2200,"memory_limit":256,"tags":["提高"],"operation":{"submit":"https://oj.iqzsy.xyz/problem/5222#submit_code","submissions":"https://oj.iqzsy.xyz/submissions?problem_id=5222","statistics":"https://oj.iqzsy.xyz/problem/5222/statistics/fastest","testdata":"https://oj.iqzsy.xyz/problem/5222/testdata","discussion":"https://oj.iqzsy.xyz/discussion/problem/5222"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"【题目背景】\r\n小 E 是一位实力强大的 OIer，经常在各类比赛中随手 AK 虐场。然而她最近秒题时遇到了\r\n一道需要她思考 15 秒才能做出的题目，整整花了 15 倍于其他题目的时间。她认为这个问题\r\n十分有意思，并且对其进行了一些拓展和修改以后抛给了你。你能接受小 E 的挑战吗？\r\n\r\n【题目描述】\r\n\r\n设 $p_i$ 表示非负整数 $p$ 的二进制表示中在项 $2^i$ 前的系数，对于非负整数 $p,q$ ，可以定义二元 运算$xnor$ （同或）为： $p$ $\\text{xnor}$ $q=\\sum_{i=0}^M ((p_i \\land q_i) \\lor (\\lnot (p_i \\lor q_i))) \\times 2^i$（在这里我们认为布尔表达式的值 false 或 true 能够直接对应于整数0或1并参与算术运算， 反之亦然； 其中 $M$ 为常数，本题中 $M$ 的取值为31）。\r\n给定一个长度为 $n$ 的非负整数序列 $a$，在序列的每个位置上有非负整数权值 $w_i$ ，现在希望实现对该序列的以下操作：\r\n\r\n1. 给定区间 $[l,r]$ 和非负整数 $k$ ，查询 $(\\sum_{i=l}^r a_i \\times w'(i))$ $xnor$ $(\\sum_{i=l}^r a_i)$ 。其中 $w'(i)=\\begin{cases} w_i, if w_i \\le k \\\\ 0 ,if w_i > k\\end{cases}$\r\n\r\n2. 给定正整数$p$ 和非负整数 $k$ ，将 $a_p$ 的值修改为 $k$。\r\n\r\n3. 给定正整数$p$ 和非负整数 $k$ ，将 $w_p$ 的值修改为$k$ 。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"输入的第 1 行包含两个整数 $ n, q$ ，$n$ 表示序列长度，$q$ 表示操作次数。\r\n\r\n接下来 1 行，包含 $n$ 个整数，其中第 $i$ 个表示 $a_i$ 。\r\n\r\n接下来 1 行，包含 $n$ 个整数，其中第 $i$ 个表示 $w_i$ 。\r\n\r\n接下来 $q$ 行，每行包含 4 个或 3 个整数，其中第 1 个整数表示操作类型（见题目描述）。\r\n\r\n对于第 1 种操作，接下来 3 个整数依次表示 $l,r,k$ ；对于第 2 或第 3 种操作，接下来 2 个整数依次表示 $p,k$ 。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"对于每个第 1 种操作输出一行一个整数，表示答案。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"### 【输入输出样例 1】\r\n\r\n输入\r\n``` plain\r\n10 10\r\n13 15 23 45 21 23 14 26 35 44\r\n12 32 15 47 15 32 12 47 32 32\r\n1 2 8 17\r\n2 4 26\r\n1 1 6 47\r\n3 9 6\r\n2 9 4\r\n1 1 7 5\r\n3 7 6\r\n2 7 2\r\n3 3 6\r\n1 4 9 6\r\n```\r\n\r\n输出\r\n``` plain\r\n4294966372\r\n4294964016\r\n4294967160\r\n4294967229\r\n```\r\n"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"【样例1说明】\r\n\r\n对于第1次询问， $k = 17$  ，此时在 $[2,8]$ 区间内第3、第5和第7位置上的 $w_i \\le 17$  。因此答案为 $(a_3 \\times w_3 + a_5 \\times w_5 + a_7 \\times w_7 )$ 。按照定义式计算即可得上式的值。 对于第3次询问，此时序列上的权值为$w = {12,32,15,47,15,32,12,47,6,32}$。 $ k = 5 $ ，但不存在 $w_i \\le 5$ 的位置，因此答案为 $0$ $xnor$ $(\\sum_{i=1}^7 a_i)$ 。 \r\n\r\n【输入输出样例2】\r\n\r\n见下发文件中的`challenge2.in`和`challenge2.out`。\r\n\r\n【数据范围与约定】\r\n\r\n对于全部数据，有 $1 \\le n,q \\le 10^5$， $0 \\le a_i,w_i,k \\le 10^5$，$ 1 \\le l,r,p \\le n$ 。下表中留空的位置代表该测试点在这一项目上没有特殊约定。\r\n\r\n![捕获.JPG](https://i.loli.net/2018/11/07/5be2a1a3859cc.jpg)\r\n\r\n【提示】\r\n\r\n $\\land$ 表示逻辑与（即布尔代数中的与运算and），$\\lnot$ 表示逻辑非（即布尔代数中的非运算not）。\r\n\r\n由于本题时限较大，为节省评测时间，建议选手在程序中判断输入数据的规模并在程序会运行超时的数据点自行退出程序。"}]}