{"title":"「长乐集训 2017 Day3」染颜色","time_limit":2000,"memory_limit":512,"tags":[],"operation":{"submit":"https://oj.iqzsy.xyz/problem/5007#submit_code","submissions":"https://oj.iqzsy.xyz/submissions?problem_id=5007","statistics":"https://oj.iqzsy.xyz/problem/5007/statistics/fastest","testdata":"https://oj.iqzsy.xyz/problem/5007/testdata","discussion":"https://oj.iqzsy.xyz/discussion/problem/5007"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"给定一棵有 $ n $ 个节点的树， 节点从 $ 0 $ 开始编号，$ 0 $ 号点为根。初始时 $ i $ 号点颜色为 $ i $ 。\r\n\n\r\n\n从一个点出发可以移动到与它有边相连的点，若两个点颜色不同则代价为 $ 1 $ ，否则代价为 $ 0 $ 。\r\n\n\r\n\n接下来会有若干次操作，操作有两种：\r\n\n\r\n\n1. 新增颜色操作：指定一个节点 $ u $ ，将 $ u $ 到根的路径上的所有节点的颜色，统一染为一个从未出现过的新颜色。\r\n\n\r\n\n2. 询问操作：给定结点 $ u $ ，询问以 $ u $ 为根的子树内的所有结点，他们走到根结点（ $ 0 $ 号点）的代价和的平均值。\r\n\n\r\n\n现在请你给出每次询问的答案。\r\n\n"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行一个整数 $ n $ ，表示树的结点数。\r\n\n\r\n\n接下来 $ n - 1 $ 行，每行两个整数 $ u $ ，$ v $ 表示一条边。\r\n\n\r\n\n接下来一行一个整数 $ Q $ ， 表示接下来有 $ Q $ 次操作，每次操作包括一个字符 $ c $ 和一个整数 $ u $。\r\n\n\r\n\n若 $ c $ 为小写字母 $ \\texttt{q} $  ，则表示询问以 $ u $ 为根的子树中，所有结点代价和的平均值。\r\n\n\r\n\n若 $ c $ 为大写字母 $ \\texttt{O} $ ，则表示一次对点 $ u $ 执行的新增颜色操作。\r\n\n"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"对于每一次询问输出一行一个实数表示答案。答案与标准输出绝对误差不超过 $ 10 ^ {-6} $ 即算正确。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入\r\n```plain\r\n13\r\n0 1\r\n0 2\r\n1 11\r\n1 10\r\n1 9\r\n9 12\r\n2 5\r\n5 8\r\n2 4\r\n2 3\r\n4 6\r\n4 7\r\n7\r\nq 0\r\nO 4\r\nq 6\r\nq 2\r\nO 9\r\nq 9\r\nq 2\r\n```\r\n\r\n#### 样例输出\r\n```plain\r\n2.0000000000\r\n1.0000000000\r\n0.8571428571\r\n0.5000000000\r\n1.8571428571\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"$ 20 \\% $ 的数据：$ n, Q \\leq 8000 $  \r\n\n另有 $ 20 \\% $ 的数据：树为随机生成  \r\n\n$ 70 \\% $ 的数据：$ n, Q \\leq 50000 $  \r\n\n$ 100 \\% $ 的数据：$ 1 \\leq n, Q \\leq 150000 $"}]}