{"title":"[数据结构]旅行(bzoj3531)","time_limit":1000,"memory_limit":512,"tags":[],"operation":{"submit":"https://oj.iqzsy.xyz/problem/1173#submit_code","submissions":"https://oj.iqzsy.xyz/submissions?problem_id=1173","statistics":"https://oj.iqzsy.xyz/problem/1173/statistics/fastest","testdata":"https://oj.iqzsy.xyz/problem/1173/testdata","discussion":"https://oj.iqzsy.xyz/discussion/problem/1173"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"S国有N个城市，编号从1到N。城市间用N-1条双向道路连接，满足\r\n从一个城市出发可以到达其它所有城市。每个城市信仰不同的宗教，如飞天面条神教、隐形独角兽教、绝地教都是常见的信仰。为了方便，我们用不同的正整数代表各种宗教，  S国的居民常常旅行。旅行时他们总会走最短路，并且为了避免麻烦，只在信仰和他们相同的城市留宿。当然旅程的终点也是信仰与他相同的城市。S国政府为每个城市标定了不同的旅行评级，旅行者们常会记下途中（包括起点和终点）留宿过的城市的评级总和或最大值。\r\n在S国的历史上常会发生以下几种事件：\r\n”CC x c”：城市x的居民全体改信了c教；\r\n”CW x w”：城市x的评级调整为w;\r\n”QS x y”：一位旅行者从城市x出发，到城市y，并记下了途中留宿过的城市的评级总和；\r\n”QM x y”：一位旅行者从城市x出发，到城市y，并记下了途中留宿过\r\n的城市的评级最大值。\r\n由于年代久远，旅行者记下的数字已经遗失了，但记录开始之前每座城市的信仰与评级，还有事件记录本身是完好的。请根据这些信息，还原旅行者记下的数字。    为了方便，我们认为事件之间的间隔足够长，以致在任意一次旅行中，所有城市的评级和信仰保持不变。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"输入的第一行包含整数N，Q依次表示城市数和事件数。\r\n接下来N行，第i+l行两个整数Wi，Ci依次表示记录开始之前，城市i的\r\n评级和信仰。\r\n接下来N-1行每行两个整数x，y表示一条双向道路。\r\n接下来Q行，每行一个操作，格式如上所述。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"对每个QS和QM事件，输出一行，表示旅行者记下的数字。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"Sample Input\r\n```\r\n5 6\r\n3 1\r\n2 3\r\n1 2\r\n3 3\r\n5 1\r\n1 2\r\n1 3\r\n3 4\r\n3 5\r\nQS 1 5\r\nCC 3 1\r\nQS 1 5\r\nCW 3 3\r\nQS 1 5\r\nQM 2 4\r\n```\r\nSample Output\r\n```\r\n8\r\n9\r\n11\r\n3\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"N，Q < =10^5    ， C < =10^5\r\n\r\n数据保证对所有QS和QM事件，起点和终点城市的信仰相同；在任意时刻，城市的评级总是不大于10^4的正整数，且宗教值不大于C。"}]}