{"title":"Night 的迷宫逃离问题","time_limit":1000,"memory_limit":512,"tags":[],"operation":{"submit":"https://oj.iqzsy.xyz/problem/6027#submit_code","submissions":"https://oj.iqzsy.xyz/submissions?problem_id=6027","statistics":"https://oj.iqzsy.xyz/problem/6027/statistics/fastest","testdata":"https://oj.iqzsy.xyz/problem/6027/testdata","discussion":"https://oj.iqzsy.xyz/discussion/problem/6027"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"很久很久以前，$\\text{Night}$ 就发现了一个神奇的迷宫，它位于神话中的冰雾世界，亡灵之国——尼福尔海姆（$\\text{Niflheimr}$）之中，传说这个迷宫能反映出人们心中最深的渴望，并赐予成功走到终点（当然你要先穿过 $\\text{Niflheimr}$）的勇者一件最适合他自己的神器。\r\n\n\r\n\n$\\text{Night}$ 心动了，这样的物品能让他在与 $\\text{R_rank_Pyramid}$ 以亿年为单位纷争的平衡中摆脱出来，真正地占到上风。\r\n\n\r\n\n能抗衡 $\\text{R_rank_Pyramid}$ 的 $\\text{Night}$ 岂是泛泛之辈，$\\text{Niflheimr}$ 里英灵的攻击甚至没有 $\\text{R_rank_Pyramid}$ 的平时的呼吸，血脉的律动来得更有威力，自然拦不住他。\r\n\n\r\n\n $\\text{Night}$ 很快便穿过了亡灵国度，来到了这个迷宫之前。他查阅的资料表明：这个迷宫由 $N$ 个分叉路口和 $M$ 条双向的通道构成，每两个分叉路口之间最多只有一条通道，在不同的通道上行走可能需要不同的时间。\r\n\n\r\n\n这不就是一个水水的最短路吗？$\\text{Night}$ 很快地对于每个路口，运用了 $\\text{DFS(Depth-First-Search)}$ 算法求出了两两分叉路口之间的最短路（至于为啥 $\\text{Night}$ 的 $\\text{DFS}$ 能跑 $100000$ 呢，因为这是偷偷运用 $\\text{R_rank_Pyramid}$ 所开发的无敌超算跑出来的），并迅速沿着最短路走到了位于迷宫最深处的 $0$ 号节点。\r\n\n\r\n\n在迷宫的最深处，$\\text{Night}$ 发现了无价的宝藏——原初之翼，这可是体现世界真实的传奇物品，他十分兴奋，没有考虑太多便取了下来。\r\n\n\r\n\n问题大了！$\\text{Night}$ 由于不够小心，触发了迷宫的防卫装置，如果他没有尽快逃出迷宫，就会被迷宫拖入无尽的时光轮回之中，永远也无法解脱。\r\n\n\r\n\n在这 $N$ 个路口里面，$\\text{Night}$ 知道有 $K$ 个路口是这个迷宫的出口，他只需要走到这 $K$ 个路口中的其中一个便可以逃离，避免陷入可怕的轮回。\r\n\n\r\n\n$\\text{Night}$ 不慌不忙地沿着他之前所求出的最短路走过去，但是这迷宫的防卫装置岂会如此简单，他不仅会让你如果没有快速逃脱便把你拖入无尽的时光轮回之中，还能封锁你前进的路线，让你无法逃脱，最终陷入轮回。\r\n\n\r\n\n幸好，$\\text{Night}$ 多年对抗 $\\text{R_rank_Pyramid}$ 的实力使得他能够对路线的封锁进行一定的影响，让它在任意时刻只能堵住一个通道，给 $\\text{Night}$ 创造生机。换句话说，每当一条路被封堵住时，另一条路就会打开。\r\n\n\r\n\n$\\text{Night}$ 的逃生过程可以形式化地描述如下：每次他试图离开一个路口时，迷宫都会封闭一条连接该路口的通道。$\\text{Night}$ 只能选择没有被封闭的通道走到下一个路口。一旦 $\\text{Night}$ 进入一条通道，在她到达该通道的另一端前，迷宫便不能封闭这条通道。当 $\\text{Night}$ 到达下一个路口，迷宫就会选择再封闭一条通道（可以是 $\\text{Night}$ 刚刚走过的那条通道）。\r\n\n\r\n\n$\\text{Night}$ 需要设计一个逃生计划，确切地说，她希望有一系列指令告诉他如何逃离这个迷宫。\r\n\n\r\n\n设 $x$ 是一个路口，如果 $x$ 是出口，$\\text{Night}$ 可以直接逃生。否则，对路口 $\\text{Night}$，指令是下列形式中的一种：\r\n\n\r\n\n> $\\bullet$ 在路口 $x$，优先选择一条通道到路口 $y$。如果该通道被封堵，则选择另一通道去路口 $z$。\r\n\n\r\n\n> $\\bullet$ 不用考虑路口 $x$，按照逃生计划不会到达 $x$。\r\n\n\r\n\n注意：数据保证不管迷宫如何封闭通道，总能找到一个好的逃生计划保证 $\\text{Night}$ 在有限时间内可以到达一个出口。\r\n\n\r\n\n在所有逃生计划中，在最坏情况下用时最短的逃生计划所用的时间定义为 $T$。\r\n\n\r\n\n按照套路 $\\text{Night}$ 当然知道怎么逃生，但是他懒得计算，便打算考一考你，如果你能帮他算出正确的 $T$，那么 $\\text{Night}$ 就会考虑在邪恶的 $\\text{R_rank_Pyramid}$ 找你麻烦的时候保住你一次。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行三个整数 $N,M,K$，含义如题目所示，以空格隔开。\r\n\n\r\n\n接下来 $M$ 行每行三个整数 $U,V,W$，依次表示一条无向通道的两端和长度，以空格隔开。\r\n\n\r\n\n接下来 $K$ 个整数以空格隔开，表示哪些分叉路口是出口。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"一个整数，为 $\\text{Night}$ 在最坏情况下用时最短的逃生计划所用的时间。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"输入样例：\r\n\r\n```\r\n13 12 9\r\n0 1 1\r\n0 2 4\r\n0 3 11\r\n1 4 11\r\n1 5 7\r\n1 6 15\r\n2 7 3\r\n2 8 13\r\n2 9 23\r\n3 10 3\r\n3 11 1\r\n3 12 2\r\n4 5 6 7 8 9 10 11 12\r\n```\r\n\r\n输出样例：\r\n\r\n```\r\n13\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"子任务 $1$ ($19\\ pts$) 具有如下性质：\r\n\n\r\n\n> $\\bullet$ $3\\le N\\le 1000$\r\n\n\r\n\n> $\\bullet$ 这个神奇的迷宫是一个树形的结构，意味着 $M = N-1$ 且对于每一对路口 $(i,j)$ 都存在唯一的路径从 $i$ 到 $j$。\r\n\n\r\n\n> $\\bullet$ 每个出口都和且只和另一个路口连接。\r\n\n\r\n\n> $\\bullet$ 对于其它的路口，都和另外恰好三个或更多的路口连接。\r\n\n\r\n\n子任务 $2$ ($23\\ pts$) 具有如下性质：\r\n\n\r\n\n> $\\bullet$ $3\\le N\\le 100000$\r\n\n\r\n\n> $\\bullet$ 这个神奇的迷宫是一个树形的结构，意味着 $M = N-1$ 且对于每一对路口 $(i,j)$ 都存在唯一的路径从 $i$ 到 $j$。\r\n\n\r\n\n子任务 $3$ ($31\\ pts$) 具有如下性质：\r\n\n\r\n\n> $\\bullet$ $3 \\le N \\le 1000$。\r\n\n\r\n\n> $\\bullet$ $2 \\le M \\le 100000$。\r\n\n\r\n\n子任务 $4$ ($27\\ pts$) 具有如下性质：\r\n\n\r\n\n> $\\bullet$ $3 \\le N \\le 100000$。\r\n\n\r\n\n> $\\bullet$ $2 \\le M \\le 1000000$。"}]}