{"title":"「长乐集训 2017 Day10」生成树求和","time_limit":2000,"memory_limit":256,"tags":[],"operation":{"submit":"https://oj.iqzsy.xyz/problem/5030#submit_code","submissions":"https://oj.iqzsy.xyz/submissions?problem_id=5030","statistics":"https://oj.iqzsy.xyz/problem/5030/statistics/fastest","testdata":"https://oj.iqzsy.xyz/problem/5030/testdata","discussion":"https://oj.iqzsy.xyz/discussion/problem/5030"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"给定一张 $ n $ 个点 $ m $ 条边的带权无向图 $ G $，对于 $ G $ 的每一棵生成树，我们定义这棵生成树的权值为：它所包含的所有边的边权按三进制不进位加法相加所得的数。\r\n\n\r\n\n现在请你求出图 $ G $ 中所有的生成树的权值和(将生成树的权值由三进制转为十进制，做正常的十进制进位加法)。输出答案对 $ 10 ^ 9 + 7 $ 取模后的值即可。\r\n\n"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行两个整数 $ n, m $ 表示点数与边数。点从 $ 1 \\sim n $ 编号。\r\n\n\r\n\n接下来 $ m $ 行每行三个整数 $ a, b, c $ 表示一条连接 $ (a, b) $ 的边权为 $ c $ 的无向边。\r\n\n\r\n\n保证途中不会有重边与自环，边权以十进制形式给出。\r\n\n"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"仅一行一个整数表示答案。\r\n\n"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入\r\n```plain\r\n5 7\r\n3 2 7400\r\n4 1 1618\r\n4 2 9110\r\n4 3 4264\r\n5 1 537\r\n5 2 4240\r\n5 3 655\r\n```\r\n\r\n#### 样例输出\r\n```plain\r\n262221\r\n```\r\n"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"$ 30 \\% $ 的数据(共六个点)，$ n = 5, 6, 7, 8, 9, 10 $  \r\n\n$ 100 \\% $ 的数据，$ n \\leq 40, 0 \\leq c \\leq 10 ^ 4 $\r\n\n"}]}