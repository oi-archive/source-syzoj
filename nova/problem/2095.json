{"title":"「CSP-S 2019」树上的数","time_limit":2000,"memory_limit":256,"tags":["NOIP","2019","并查集","文件IO","贪心"],"operation":{"submit":"https://noj.ac/problem/2095#submit_code","submissions":"https://noj.ac/submissions?problem_id=2095","statistics":"https://noj.ac/problem/2095/statistics/fastest","testdata":"https://noj.ac/problem/2095/testdata","discussion":"https://noj.ac/discussion/problem/2095"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"给定一个大小为 $n$ 的树，它共有 $n$ 个结点与 $n − 1$ 条边，结点从 $1 \\sim n$ 编号。初始时每个结点上都有一个 $1 \\sim n$ 的数字，且每个 $1 \\sim n$ 的数字都只在**恰好**一个结点上出现。\r\n\r\n接下来你需要进行**恰好** $n − 1$ 次删边操作，每次操作你需要选一条**未被删去**的边，此时这条边所连接的两个结点上的数字将会**交换**，然后这条边将被删去。\r\n\r\n$n − 1$ 次操作过后，所有的边都将被删去。此时，按数字从小到大的顺序，将数字 $1 \\sim n$ 所在的结点编号依次排列，就得到一个结点编号的排列 $P_i$。现在请你求出，在最优操作方案下能得到的**字典序最小**的 $P_i$。\r\n\r\n![tree1.png](https://loj-img.upyun.menci.memset0.cn/2019/11/16/5dcfed30445b2.png)\r\n\r\n如上图，蓝圈中的数字 $1 \\sim 5$ 一开始分别在结点 ②、①、③、⑤、④。按照 (1)(4)(3)(2) 的顺序删去所有边，树变为下图。按数字顺序得到的结点编号排列为 ①③④②⑤，该排列是所有可能的结果中字典序最小的。\r\n\r\n![tree2.png](https://loj-img.upyun.menci.memset0.cn/2019/11/16/5dcfed30aee32.png)"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"从文件 `tree.in` 中读入数据。\r\n\r\n**本题输入包含多组测试数据**。\r\n\r\n第一行一个正整数 $T$，表示数据组数。\r\n\r\n对于每组测试数据：\r\n\r\n第一行一个整数 $n$，表示树的大小。\r\n\r\n第二行 $n$ 个整数，第 $i$（$1 \\le i \\le n$）个整数表示数字 $i$ 初始时所在的结点编号。\r\n\r\n接下来 $n − 1$ 行每行两个整数 $x, y$，表示一条连接 $x$ 号结点与 $y$ 号结点的边。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"输出到文件 `tree.out` 中。\r\n\r\n对于每组测试数据，输出一行共 $n$ 个用空格隔开的整数，表示最优操作方案下所能得到的字典序最小的 $P_i$。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入 1\r\n```plain\r\n4\r\n5\r\n2 1 3 5 4\r\n1 3\r\n1 4\r\n2 4\r\n4 5\r\n5\r\n3 4 2 1 5\r\n1 2\r\n2 3\r\n3 4\r\n4 5\r\n5\r\n1 2 5 3 4\r\n1 2\r\n1 3\r\n1 4\r\n1 5\r\n10\r\n1 2 3 4 5 7 8 9 10 6\r\n1 2\r\n1 3\r\n1 4\r\n1 5\r\n5 6\r\n6 7\r\n7 8\r\n8 9\r\n9 10\r\n```\r\n#### 样例输出 1\r\n```plain\r\n1 3 4 2 5\r\n1 3 5 2 4\r\n2 3 1 4 5\r\n2 3 4 5 6 1 7 8 9 10\r\n```\r\n#### 样例 2\r\n详见附加文件 `tree2.in/ans`。"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"| 测试点编号  |    $n\\le $     |         特殊性质          |\r\n| :---------: | :------------: | :-----------------------: |\r\n|  $1\\sim 2$  |      $10$      |            无             |\r\n|  $3\\sim 4$  |     $160$      |     树的形态是一条链      |\r\n|  $5\\sim 7$  | $2\\times 10^3$ |     树的形态是一条链      |\r\n|  $8\\sim 9$  |     $160$      | 存在度数为 $n − 1$ 的结点 |\r\n| $10\\sim 12$ | $2\\times 10^3$ | 存在度数为 $n − 1$ 的结点 |\r\n| $13\\sim 16$ |     $160$      |            无             |\r\n| $17\\sim 20$ | $2\\times 10^3$ |            无             |\r\n\r\n对于所有测试点：$1 \\le T \\le 10$，保证给出的是一个树。"}]}