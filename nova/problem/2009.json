{"title":"「NOI2018」归程","time_limit":4000,"memory_limit":512,"tags":["NOI","2018","文件IO"],"operation":{"submit":"https://noj.ac/problem/2009#submit_code","submissions":"https://noj.ac/submissions?problem_id=2009","statistics":"https://noj.ac/problem/2009/statistics/fastest","testdata":"https://noj.ac/problem/2009/testdata","discussion":"https://noj.ac/discussion/problem/2009"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"> 本题的故事发生在魔力之都，在这里我们将为你介绍一些必要的设定。\r\n>\r\n> 魔力之都可以抽象成一个 $n$ 个节点、$m$ 条边的**无向连通图**（节点的编号从 $1$ 至 $n$）。我们依次用 $l, a$ 描述一条边的**长度**、**海拔**。\r\n>\r\n> 作为季风气候的代表城市，魔力之都时常有雨水相伴，因此道路积水总是不可避免的。由于整个城市的排水系统连通，因此**有积水的边一定是海拔相对最低的一些边**。\r\n>\r\n> 我们用**水位线**来描述降雨的程度，它的意义是：所有海拔**不超过**水位线的边都是**有积水**的。\r\n\r\nYazid 是一名来自魔力之都的 OIer，刚参加完 ION2018 的他将踏上归程，回到他温暖的家。\r\n\r\nYazid 的家恰好在魔力之都的 $1$ 号节点。对于接下来 $Q$ 天，每一天 Yazid 都会告诉你他的出发点 $v$，以及当天的水位线 $p$。\r\n\r\n每一天，Yazid 在出发点都拥有一辆**车**。这辆车由于一些故障不能经过有积水的边。\r\n\r\nYazid 可以在任意节点下车，这样接下来他就可以步行经过有积水的边。但车会被留在他下车的节点并不会再被使用。\r\n\r\n+ 需要特殊说明的是，第二天车会被重置，这意味着：\r\n  + 车会在新的出发点被准备好。\r\n  + Yazid 不能利用之前在某处停放的车。\r\n\r\nYazid 非常讨厌在雨天步行，因此他希望在完成回家这一目标的同时，最小化他**步行经过的**边的总长度。请你帮助 Yazid 进行计算。\r\n\r\n**本题的部分测试点将强制在线，具体细节请见「输入格式」和「子任务」。**"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"从文件 `return.in` 读入数据。\r\n\r\n单个测试点中包含多组数据。输入的第一行为一个非负整数 $T$，表示数据的组数。\r\n\r\n接下来依次描述每组数据，对于每组数据：\r\n\r\n+ 第一行 $2$ 个非负整数 $n, m$，分别表示节点数、边数。\r\n+ 接下来 $m$ 行，每行 $4$ 个正整数 $u, v, l, a$，描述一条连接节点 $u, v$ 的、长度为 $l$、海拔为 $a$ 的边。\r\n  + 在这里，我们保证 $1 \\leq u, v \\leq n$。\r\n+ 接下来一行 $3$ 个非负数 $Q, K, S$，其中：\r\n  + $Q$ 表示总天数，\r\n  + $K \\in \\{0, 1\\}$ 是一个会在下面被用到的系数，\r\n  + $S$ 表示的是可能的最高水位线。\r\n+ 接下来 $Q$ 行依次描述每天的状况。每行 $2$ 个整数 $v_0 , p_0$ 描述一天：\r\n  + 这一天的出发节点为 $v = (v_0 + K \\times \\text{lastans}  − 1) \\bmod n + 1$。\r\n  + 这一天的水位线为 $p = (p_0 + K \\times \\text{lastans} ) \\bmod (S + 1)$。\r\n  + 其中 $\\text{lastans}$ 表示上一天的答案（最小步行总路程）。特别地，我们规定第 $1$ 天时 $\\text{lastans} = 0$。\r\n  + 在这里，我们保证 $1 \\leq v_0 \\leq n,0 \\leq p_0 \\leq S$。\r\n\r\n对于输入中的每一行，如果该行包含多个数，则用单个空格将它们隔开。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"输出到文件 `return.out` 中。\r\n\r\n依次输出各组数据的答案。对于每组数据：\r\n\r\n+ 输出 $Q$ 行每行一个整数，依次表示每天的最小步行总路程。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入 1\r\n\r\n```plain\r\n1\r\n4 3\r\n1 2 50 1\r\n2 3 100 2\r\n3 4 50 1\r\n5 0 2\r\n3 0\r\n2 1\r\n4 1\r\n3 1\r\n3 2\r\n```\r\n\r\n#### 样例输出 1\r\n\r\n```plain\r\n0\r\n50\r\n200\r\n50\r\n150\r\n```\r\n\r\n#### 样例解释 1\r\n\r\n第一天没有降水，Yazid 可以坐车直接回到家中。\r\n\r\n第二天、第三天、第四天的积水情况相同，均为连接 $1, 2$ 号节点的边、连接 $3, 4$ 号点的边有积水。\r\n\r\n对于第二天，Yazid 从 $2$ 号点出发坐车只能去往 $3$ 号节点，对回家没有帮助。因此 Yazid 只能纯靠徒步回家。\r\n\r\n对于第三天，从 $4$ 号节点出发的唯一一条边是有积水的，车也就变得无用了。Yazid 只能纯靠徒步回家。\r\n\r\n对于第四天，Yazid 可以坐车先到达 $2$ 号节点，再步行回家。\r\n\r\n第五天所有的边都积水了，因此 Yazid 只能纯靠徒步回家。\r\n\r\n#### 样例输入 2\r\n\r\n```plain\r\n1\r\n5 5\r\n1 2 1 2\r\n2 3 1 2\r\n4 3 1 2\r\n5 3 1 2\r\n1 5 2 1\r\n4 1 3\r\n5 1\r\n5 2\r\n2 0\r\n4 0\r\n```\r\n\r\n#### 样例输出 2\r\n\r\n```plain\r\n0\r\n2\r\n3\r\n1\r\n```\r\n\r\n#### 样例解释 2\r\n\r\n本组数据强制在线。\r\n\r\n第一天的答案是 $0$，因此第二天的 $v = (5 + 0 − 1) \\bmod 5 + 1 = 5,p = (2 + 0) \\bmod (3 + 1) = 2$。\r\n\r\n第二天的答案是 $2$，因此第三天的 $v = (2 + 2 − 1) \\bmod 5 + 1 = 4,p = (0 + 2) \\bmod (3 + 1) = 2$。\r\n\r\n第三天的答案是 $3$，因此第四天的 $v = (4 + 3 − 1) \\bmod 5 + 1 = 2,p = (0 + 3) \\bmod (3 + 1) = 3$。\r\n\r\n#### 样例 3\r\n见附加文件中的 `return3.in` 与 `return3.ans`.\r\n\r\n#### 样例 4\r\n见附加文件中的 `return4.in` 与 `return4.ans`.\r\n\r\n#### 样例 5\r\n见附加文件中的 `return5.in` 与 `return5.ans`."},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"**所有测试点均保证 $T \\leq 3$，所有测试点中的所有数据均满足如下限制：**\r\n\r\n+ $n \\leq 2 \\times 10^5$，$m \\leq 4 \\times 10^5$，$Q \\leq 4 \\times 10^5$，$K \\in \\{0, 1\\}$，$1 \\leq S \\leq 10^9$。\r\n+ 对于所有边：$l \\leq 10^4$，$a \\leq 10^9$。\r\n+ 任意两点之间都直接或间接通过边相连。\r\n\r\n**为了方便你快速理解，我们在表格中使用了一些简单易懂的表述。在此，我们对这些内容作形式化的说明：**\r\n\r\n+ 图形态：对于表格中该项为「一棵树」或「一条链」的测试点，保证 $m = n − 1$。除此之外，这两类测试点分别满足如下限制：\r\n  + 一棵树：保证输入的图是一棵树，即保证边不会构成回路。\r\n  + 一条链：保证所有边满足 $u + 1 = v$。\r\n+ 海拔：对于表格中该项为「一种」的测试点，保证对于所有边有 $a = 1$。\r\n+ 强制在线：对于表格中该项为「是」的测试点，保证 $K = 1$；如果该项为「否」，则有 $K = 0$。\r\n+ 对于所有测试点，如果上述对应项为「不保证」，则对该项内容不作任何保证。\r\n\r\n|$n$|$m$|$Q=$|测试点|图形态|海拔|强制在线|\r\n|:---:|:----:|:-----:|:-------:|:-------:|:----:|:----------:|\r\n|$\\leq 1$|$\\leq 0$|$0$|$1$|不保证|一种|否|\r\n|$\\leq 6$|$\\leq 10$|$10$|$2$|不保证|一种|否|\r\n|$\\leq 50$|$\\leq 150$|$100$|$3$|不保证|一种|否|\r\n|$\\leq 100$|$\\leq 300$|$200$|$4$|不保证|一种|否|\r\n|$\\leq 1500$|$\\leq 4000$|$2000$|$5$|不保证|一种|否|\r\n|$\\leq 200000$|$\\leq 400000$|$100000$|$6$|不保证|一种|否|\r\n|$\\leq 1500$|$=n-1$|$2000$|$7$|一条链|不保证|否|\r\n|$\\leq 1500$|$=n-1$|$2000$|$8$|一条链|不保证|否|\r\n|$\\leq 1500$|$=n-1$|$2000$|$9$|一条链|不保证|否|\r\n|$\\leq 200000$|$=n-1$|$100000$|$10$|一棵树|不保证|否|\r\n|$\\leq 200000$|$=n-1$|$100000$|$11$|一棵树|不保证|是|\r\n|$\\leq 200000$|$\\leq 400000$|$100000$|$12$|不保证|不保证|否|\r\n|$\\leq 200000$|$\\leq 400000$|$100000$|$13$|不保证|不保证|否|\r\n|$\\leq 200000$|$\\leq 400000$|$100000$|$14$|不保证|不保证|否|\r\n|$\\leq 1500$|$\\leq 4000$|$2000$|$15$|不保证|不保证|是|\r\n|$\\leq 1500$|$\\leq 4000$|$2000$|$16$|不保证|不保证|是|\r\n|$\\leq 200000$|$\\leq 400000$|$100000$|$17$|不保证|不保证|是|\r\n|$\\leq 200000$|$\\leq 400000$|$100000$|$18$|不保证|不保证|是|\r\n|$\\leq 200000$|$\\leq 400000$|$400000$|$19$|不保证|不保证|是|\r\n|$\\leq 200000$|$\\leq 400000$|$400000$|$20$|不保证|不保证|是|\r\n<!--\r\n<table><thead>\r\n<tr>\r\n<th style='text-align:center'>$n$ </th><th style='text-align:center'>$m$ </th><th style='text-align:center'>$Q =$ </th><th style='text-align:center'>测试点</th><th style='text-align:center'>图形态</th><th style='text-align:center'>海拔</th><th style='text-align:center'>强制在线</th></tr>\r\n</thead><tbody>\r\n<tr>\r\n<td style='text-align:center'>$\\leq 1$ </td><td style='text-align:center'>$\\leq 0$ </td><td style='text-align:center'>$0$ </td><td style='text-align:center'>1</td><td style='text-align:center' rowspan='6'>不保证</td><td style='text-align:center' rowspan='6'>一种</td><td style='text-align:center' rowspan='10'>否</td></tr>\r\n<tr>\r\n<td style='text-align:center'>$\\leq 6$ </td><td style='text-align:center'>$\\leq 10$ </td><td style='text-align:center'>$10$ </td><td style='text-align:center'>2</td></tr>\r\n<tr>\r\n<td style='text-align:center'>$\\leq 50$ </td><td style='text-align:center'>$\\leq 150$ </td><td style='text-align:center'>$100$ </td><td style='text-align:center'>3</td></tr>\r\n<tr>\r\n<td style='text-align:center'>$\\leq 100$ </td><td style='text-align:center'>$\\leq 300$ </td><td style='text-align:center'>$200$ </td><td style='text-align:center'>4</td></tr>\r\n<tr>\r\n<td style='text-align:center'>$\\leq 1500$ </td><td style='text-align:center'>$\\leq 4000$ </td><td style='text-align:center'>$2000$ </td><td style='text-align:center'>5</td></tr>\r\n<tr>\r\n<td style='text-align:center'>$\\leq 200000$ </td><td style='text-align:center'>$\\leq 400000$ </td><td style='text-align:center'>$100000$ </td><td style='text-align:center'>6</td></tr>\r\n<tr>\r\n<td style='text-align:center' rowspan='3'>$\\leq 1500$ </td><td style='text-align:center' rowspan='5'>$= n - 1$ </td><td style='text-align:center' rowspan='3'>$2000$ </td><td style='text-align:center'>7</td><td style='text-align:center' rowspan='3'>一条链</td><td style='text-align:center' rowspan='14'>不保证</td></tr>\r\n<tr>\r\n<td style='text-align:center; border-left:1px solid rgba(34,36,38,.1)'>8</td></tr>\r\n<tr>\r\n<td style='text-align:center; border-left:1px solid rgba(34,36,38,.1)'>9</td></tr>\r\n<tr>\r\n<td style='text-align:center' rowspan='5'>$\\leq 200000$ </td><td style='text-align:center' rowspan='5'>$100000$ </td><td style='text-align:center'>10</td><td style='text-align:center' rowspan='2'>一棵树</td></tr>\r\n<tr>\r\n<td style='text-align:center; border-left:1px solid rgba(34,36,38,.1)'>11</td><td style='text-align:center'>是</td></tr>\r\n<tr>\r\n<td style='text-align:center; border-left:1px solid rgba(34,36,38,.1)' rowspan='3'>$\\leq 400000$ </td><td style='text-align:center'>12</td><td style='text-align:center' rowspan='9'>不保证</td><td style='text-align:center' rowspan='3'>否</td></tr>\r\n<tr>\r\n<td style='text-align:center; border-left:1px solid rgba(34,36,38,.1)'>13</td></tr>\r\n<tr>\r\n<td style='text-align:center; border-left:1px solid rgba(34,36,38,.1)'>14</td></tr>\r\n<tr>\r\n<td style='text-align:center' rowspan='2'>$\\leq 1500$ </td><td style='text-align:center' rowspan='2'>$\\leq 4000$ </td><td style='text-align:center' rowspan='2'>$2000$ </td><td style='text-align:center'>15</td><td style='text-align:center' rowspan='6'>是</td></tr>\r\n<tr>\r\n<td style='text-align:center; border-left:1px solid rgba(34,36,38,.1)'>16</td></tr>\r\n<tr>\r\n<td style='text-align:center' rowspan='4'>$\\leq 200000$ </td><td style='text-align:center' rowspan='4'>$\\leq 400000$ </td><td style='text-align:center' rowspan='2'>$100000$ </td><td style='text-align:center'>17</td></tr>\r\n<tr>\r\n<td style='text-align:center; border-left:1px solid rgba(34,36,38,.1)'>18</td></tr>\r\n<tr>\r\n<td style='text-align:center; border-left:1px solid rgba(34,36,38,.1)' rowspan='2'>$400000$ </td><td style='text-align:center'>19</td></tr>\r\n<tr>\r\n<td style='text-align:center; border-left:1px solid rgba(34,36,38,.1)'>20</td></tr>\r\n</tbody></table>\r\n-->\r\n为了优化你的阅读体验，我们在表格中把测试点的编号放在了中间，请注意这一点。"}]}