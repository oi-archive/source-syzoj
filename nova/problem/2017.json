{"title":"「CTSC2018」青蕈领主","time_limit":3000,"memory_limit":512,"tags":["CTSC","2018"],"operation":{"submit":"https://noj.ac/problem/2017#submit_code","submissions":"https://noj.ac/submissions?problem_id=2017","statistics":"https://noj.ac/problem/2017/statistics/fastest","testdata":"https://noj.ac/problem/2017/testdata","discussion":"https://noj.ac/discussion/problem/2017"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"> “也许，我的生命也已经如同风中残烛了吧。”小绿如是说。\r\n\r\n小绿同学因为微积分这门课，对“连续”这一概念产生了浓厚的兴趣。小绿打算把连续的概念放到由整数构成的序列上，他定义一个长度为 $m$ 的整数序列是连续的，当且仅当这个序列中的最大值与最小值的差，不超过$m-1$。例如 $\\{1,3,2\\}$ 是连续的，而 $\\{1,3\\}$ 不是连续的。\r\n\r\n某天，小绿的顶头上司板老大，给了小绿 $T$ 个长度为 $n$ 的排列。小绿拿到之后十分欢喜，他求出了每个排列的每个区间是否是他所定义的“连续”的。然而，小绿觉得被别的“连续”区间包含住的“连续”区间不够优秀，于是对于每个排列的所有右端点相同的“连续”区间，他只记录下了长度最长的那个“连续”区间的长度。也就是说，对于板老大给他的每一个排列，他都只记录下了在这个排列中，对于每一个 $1 \\le i \\le n$，右端点为 $i$ 的最长“连续”区间的长度 $L_i$。显然这个长度最少为 $1$，因为所有长度为 $1$ 的整数序列都是连续的。\r\n\r\n做完这一切后，小绿爬上绿色床，美美地做了一个绿色的梦。\r\n\r\n可是第二天醒来之后，小绿惊讶的发现板老大给他的所有排列都不见了，只剩下他记录下来的 $T$ 组信息。小绿知道自己在劫难逃，但是作为一个好奇的青年，他还是想知道：对于每一组信息，有多少个和信息符合的长度为 $n$ 的排列。\r\n\r\n由于小绿已经放弃治疗了，你只需要告诉他每一个答案对 $998244353$ 取模的结果。\r\n\r\n我们并不保证一定存在至少一个符合信息的排列，因为小绿也是人，他也有可能犯错。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"输入的第一行包含两个整数 $T,n$，分别表示板老大给小绿的排列个数、以及每个排列的长度。\r\n\r\n接下来 $T$ 行，每行描述一组信息，包含 $n$ 个正整数，第 $i$ 组信息的从左往右第 $j$ 个整数 $L_{i,j}$ 表示第 $i$ 个排列中右端点为第 $j$ 个数的最长“连续”区间的长度。\r\n\r\n对于每一行，如果行内包含多个数，则用单个空格将它们隔开。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"对于每组信息，输出一行一个整数表示可能的排列个数对 $998244353$ 取模的结果。由于是计算机帮你算，所以我们不给你犯错的机会。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入 1\r\n```plain\r\n1 3\r\n1 1 3\r\n```\r\n\r\n#### 样例输出 1\r\n```plain\r\n2\r\n```\r\n\r\n#### 样例2 & 样例 3\r\n见附加文件。"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"| 测试点编号 | $n\\le$  | $T\\le$ |        特殊性质         |   \r\n| :---: | :-----: | :----: | :-----------------: |   \r\n|  1~2  |  $10$   |   1    |          无          |   \r\n|  3~4  |  $10$   |  100   |          无          |   \r\n|   5   |  $300$  |   1    |    $ L_{i,j}=j$     |   \r\n|   6   |  $300$  |   1    | $L_{i,j}=1$ 且 $j<n$ |   \r\n|  7~8  |  $300$  |  100   |          无          |   \r\n|   9   | $1000$  |   1    | $L_{i,j}=1$ 且 $j<n$ |   \r\n| 10~12 | $1000$  |  100   |          无          |   \r\n| 13~16 | $5000$  |  100   |          无          |   \r\n| 17~20 | $50000$ |  100   |          无          |   \r\n\r\n对于所有测试数据，$1 \\le T \\le 100$，$1 \\le N \\le 50000$, $1 \\le L_{i,j} \\le j$。   \r\n本题部分测试点的输入规模较大，请注意读入效率。   "}]}