{"title":"「CTS2019」随机立方体","time_limit":5000,"memory_limit":512,"tags":["CTSC","2019"],"operation":{"submit":"https://noj.ac/problem/2078#submit_code","submissions":"https://noj.ac/submissions?problem_id=2078","statistics":"https://noj.ac/problem/2078/statistics/fastest","testdata":"https://noj.ac/problem/2078/testdata","discussion":"https://noj.ac/discussion/problem/2078"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"有一个 $n\\times m\\times l$ 的立方体，立方体中每个格子上都有一个数，如果某个格子上的数比三维坐标**至少有一维**相同的其他格子上的数都要大的话，我们就称它是极大的。  \r\n现在将 $1\\sim n\\times m\\times l$ 这 $n\\times m\\times l$ 个数等概率随机填入 $n\\times m\\times l$ 个格子（即任意数字出现在任意格子上的概率均相等），使得每个数恰出现一次，求恰有 $k$ 个极大的数的概率。答案对 $998244353$（一个质数）取模。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"输入包含多组数据。输入第一行包含一个正整数 $T$，表示数据组数。  \r\n接下来 $T$ 行，每行一组数据，包含 $4$ 个正整数 $n,m,l,k$，表示一次询问。 "},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"对于每次询问，输出一行一个整数，表示答案对 $998244353$ 取模的余数。  \r\n可以证明，答案一定为有理数。设其为 $a/b$（$a$ 和 $b$ 为互质的正整数，数据保证 $b$ 不为 $998244353$ 的倍数），则你需要保证输出的数 $x$ 满足 $0\\le x < 998244353$ 且 $a\\equiv bx \\pmod{998244353}$。可以证明这样的 $x$ 唯一存在。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入 1\r\n```plain\r\n5\r\n1 1 1 1\r\n2 2 2 1\r\n7 8 9 3\r\n123 456 789 1\r\n1000 1000 1000 10\r\n```\r\n\r\n#### 样例输出 1\r\n```plain\r\n1\r\n142606337\r\n736950806\r\n246172965\r\n189652652\r\n```\r\n\r\n#### 样例 2\r\n\r\n见附加文件中的 `cube2.in` 与 `cube2.ans`。\r\n"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于 $10\\%$ 的数据，$n,m\\le 2$，$l\\le 3$，$k=1$。  \r\n对于 $30\\%$ 的数据，$n,m,l,k\\le 12$。  \r\n对于 $40\\%$ 的数据，$n,m,l\\le 100$。  \r\n对于 $50\\%$ 的数据，$n,m,l\\le 1000$。  \r\n对于 $60\\%$ 的数据，$n,m,l\\le 100000$，其中有占全部数据 $30\\%$ 的数据保证 $k=1$。  \r\n对于 $80\\%$ 的数据，$n,m,l\\le 1000000$，其中有占全部数据 $40\\%$ 的数据保证 $k=1$。  \r\n对于 $100\\%$ 的数据，$1\\le n,m,l\\le 5000000$，$1\\le k\\le 100$，$1\\le T\\le 10$。\r\n\r\n其中有 $50\\%$ 的数据保证 $k=1$。"}]}