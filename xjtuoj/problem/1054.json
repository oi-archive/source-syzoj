{"title":"1-06G. nocriz和巨佬谈人生","time_limit":750,"memory_limit":512,"tags":["2019小学期"],"operation":{"submit":"https://oj.xjtuicpc.com/problem/1054#submit_code","submissions":"https://oj.xjtuicpc.com/submissions?problem_id=1054","statistics":"https://oj.xjtuicpc.com/problem/1054/statistics/fastest","testdata":"https://oj.xjtuicpc.com/problem/1054/testdata","discussion":"https://oj.xjtuicpc.com/discussion/problem/1054"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"`nocriz`是一名对人生充满向往的同学。\r\n\r\n他和巨佬<b>A<font color = \"red\">prilGrimoire</font></b>谈起了人生。`nocriz`提出，人生就如一个不回溯的搜索，你并不知道前面有什么。<b>A<font color = \"red\">prilGrimoire</font></b>说，其实作为巨佬的人，是可以知道前面有什么的。`nocriz`在Orz之余，说即使对于巨佬有一些路能够走的人是有限的，比如<b>A<font color = \"red\">prilGrimoire</font></b>巨佬就可以走一条只有<del>50</del> <del>15</del> <del>4</del> 他自己 1 个人可以走的路。\r\n\r\n<b>A<font color = \"red\">prilGrimoire</font></b>巨佬将人生建模成了一颗树。树上不同的结点有着不同的优劣程度。一个人从根节点出发，每一次朝着可达结点编号最小的空子结点出发。具体的说，假如当前节点有且仅有一个空儿子节点，那么人就会移动到那个节点。假如有多个空儿子节点，那么人会遵循如下过程:假设人所在当前节点为 $P$，人会先寻找以 $P$ 节点为根的子树中编号最小并且和当前结点路径上有空结点的的节点，然后判断这个节点属于哪个以 $P$ 的空儿子为根的子树，最后移动到那个空儿子节点中。人会一直移动直到到达没有空儿子的节点。如图所示:两个人从节点 $4$ 处开始了他们的人生。因为编号最小的节点 $1$ 在以 $3$ 为根的子树中，所以第一个人走到了节点 $3$,然后 最后移动到了节点 $1$。同理，第个人从节点 $4$ 走到了节点 $3$ 并且停了下来。\r\n\r\n![ZMh9vd.png](https://s2.ax1x.com/2019/06/28/ZMh9vd.png)\r\n\r\n还有可能有时候人消失了，那么原先的节点就变为空节点，那么假如它的父节点有人，那么人就会走过来。比如，如图所示:假如我们在 5,7 和 8 号节点的人消失了，那么在一系列人移动之后，1,2,3 号节点就变空了。\r\n\r\n![ZMhPKA.png](https://s2.ax1x.com/2019/06/28/ZMhPKA.png)\r\n\r\n`nocriz`觉得这实在太真实，于是他记录下了这个模型，并想用计算机模拟模拟。\r\n\r\n有一颗$n$个节点的树，有两种操作\r\n\r\n- 从树根逐次生成$k$个人\r\n- 将某个节点清空，节点上的人会消失，其他人会填过来"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行两个正整数 $n$ 和 $q$。$n$ 代表有 $n$ 个节点，$q$ 代表有 $q$ 次操作。\r\n 下面 $n$ 行，每行一个整数。第 $i$ 行的整数表示编号为 $i$ 的节点的父亲节点的编号。如 \r\n\r\n果整数为 0 则说明该节点是根节点。 下面 $q$ 行，每行表示一个操作。 \r\n\r\n- 操作一:`1 k` 表示从树根逐次生成$k$个人\r\n- 操作二:`2 x` 表示将编号为 x 的节点清空。 \r\n\r\n保证所有操作合法，不会有人无处可去也不会清空空节点。 "},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"对于操作一，输出人最后走到的节点编号。\r\n\r\n对于操作二，输出清空节点之后，有移动的人的数量。 "},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 输入样例\r\n```\r\n8 4 \r\n0\r\n1\r\n2\r\n2\r\n3\r\n3\r\n4\r\n6 \r\n1 8 \r\n2 5 \r\n2 7 \r\n2 8\r\n```\r\n#### 输出样例\r\n```\r\n1\r\n3\r\n2\r\n2\r\n```\r\n样例2见附加文件"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"$1 \\le n,\\ q \\le 10^5$\r\n"}]}