{"title":"mob的《麻将与概率系统导论》加强版","time_limit":30000,"memory_limit":512,"tags":[],"operation":{"submit":"https://oj.xjtuicpc.com/problem/1084#submit_code","submissions":"https://oj.xjtuicpc.com/submissions?problem_id=1084","statistics":"https://oj.xjtuicpc.com/problem/1084/statistics/fastest","testdata":"https://oj.xjtuicpc.com/problem/1084/testdata","discussion":"https://oj.xjtuicpc.com/discussion/problem/1084"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"在打麻将的同时，mob也在十分刻苦地学习《概率论与数理统计》，他逐渐从书本和麻将实践中得到了一些启发，发现麻将的概率问题复杂性来源于其模型的高度复杂性，于是他试图发明一套新的概率方法来求解这些过于复杂的概率和统计问题。功夫不负有心人，他最终找到了规律并发明了一种他称之为“概率系统”的理念，其中有一种统计问题是整个理论的核心：\r\n\r\n有$n$个概率模式，每个概率模式有两个参数$p_i,b_i$,这$n$个概率模式组成全集$U$,对任何一个$U$的子集$S$,我们称它的mob值为：$S$中所有概率模式对应的$b_i$的异或和。此外，我们称$S$是合法的当且仅当：$S$中所有概率模式所对应的$b_i$两两按位与的结果均为$0$,我们称一个$S$出现的概率为$S$中所有概率模式对应的$p_i$的积。\r\n\r\n为了验证你是否掌握了这套概率系统理论，mob给了你$m$个询问，每个询问都给出一个$x_i$,询问：\r\n\r\n所有$mob$值为$x$的合法子集的出现概率之和为多少？\r\n\r\n由于这个数可能很大，你只需要输出答案对998244353取模的结果即可"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"\r\n第一行一个正整数$n$，表示概率模式数\r\n\r\n第$2-(n+1)$行每行两个正整数$p_i,b_i$，分别表示第$i$种概率模式的两个参数\r\n\r\n接下来一行一个正整数$m$表示询问个数\r\n\r\n接下来$m$行每行一个正整数$x_i$，表示询问"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"\r\n输出$m$行，第$i$行一个正整数表示第$i$次询问的答案"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"| 样例输入 | 样例输出 |\r\n| -------------------------- | :-------------- |\r\n| 3<br />1 1<br />1 2<br />1 3<br />3<br />1<br />2<br />3 | 1<br />1<br />2 |"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"\r\n$n,m\\leq 10^5$\r\n\r\n$0\\leq p_i<998244353$\r\n\r\n$0<b_i<2^{21}$\r\n\r\n$0<x_i<2^{21}$"}]}