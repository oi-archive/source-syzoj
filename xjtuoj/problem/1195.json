{"title":"抑制[超我]","time_limit":1000,"memory_limit":512,"tags":["2020小学期"],"operation":{"submit":"https://oj.xjtuicpc.com/problem/1195#submit_code","submissions":"https://oj.xjtuicpc.com/submissions?problem_id=1195","statistics":"https://oj.xjtuicpc.com/problem/1195/statistics/fastest","testdata":"https://oj.xjtuicpc.com/problem/1195/testdata","discussion":"https://oj.xjtuicpc.com/discussion/problem/1195"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"恋恋变魔术，有$n$个帽子，编号为$1-n$，一开始编号为$i$的帽子下有$p_i$的概率有一只兔子，恋恋要依次进行$m$次操作，其中有$k$次操作是魔法操作，$m-k$次操作是普通操作。\r\n\r\n当恋恋进行普通操作时，他会等概率地随机选择一对不同的帽子$x,y(1\\leq x,y\\leq n,x\\neq y)$,然后交换$x$号帽子和$y$号帽子的编号\r\n\r\n当恋恋进行魔法操作时，他会交换$x$号帽子和$y$号帽子的编号,但这次$x,y$是固定的而不是随机选择的。\r\n\r\n给出关于$k$次魔法操作的信息，第$i$个魔法操作形如$（t_i,x_i,y_i）$，表示这是所有操作中第$t_i$个进行的操作，交换的帽子序号为$x_i,y_i$\r\n\r\n请问所有操作结束后，对于每个编号$i$，兔子在$i$号帽子下的概率是多少，你需要输出答案对$998244353$取模结果。\r\n\r\n输入数据的$p_i$也是在$998244353$模意义下的"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"一行三个非负整数$n,m,k$\r\n\r\n下面一行$n$个非负整数，第$i$个数表示$p_i$\r\n\r\n下面$k$行每行三个正整数$(t_i,x_i,y_i)$，描述第$i$次魔法操作"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"输出$n$行，第$i$行一个非负整数表示兔子最终在$i$号帽子下概率"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入1\r\n```\r\n3 1 0\r\n1 0 0\r\n```\r\n\r\n#### 样例输出1\r\n```\r\n332748118\r\n332748118\r\n332748118\r\n```\r\n\r\n#### 样例输入2\r\n```\r\n3 1 1\r\n1 0 0\r\n1 1 2\r\n```\r\n\r\n#### 样例输出2\r\n```\r\n0\r\n1\r\n0\r\n```\r\n\r\n#### 样例输入3\r\n```\r\n3 2 1\r\n1 0 0\r\n2 2 3\r\n```\r\n\r\n#### 样例输出3\r\n```\r\n332748118\r\n332748118\r\n332748118\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"$2\\leq n,k\\leq 10^5,1\\leq k\\leq m\\leq 10^{18}$\r\n\r\n$1\\leq t_1<t_2<t_3......<t_k\\leq m,1\\leq x_i,y_i\\leq n,x_i\\neq y_i$\r\n\r\n$1\\leq x_i,y_i\\leq n,x_i\\neq y_i$\r\n\r\n$\\sum\\limits_{i=1}^np_i \\equiv 1\\pmod {998244353}$"}]}