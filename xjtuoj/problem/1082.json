{"title":"1-11G. JM的月亮神树","time_limit":1500,"memory_limit":512,"tags":["2019小学期","贪心","图论","DijkstraHeap","最短路径树"],"operation":{"submit":"https://oj.xjtuicpc.com/problem/1082#submit_code","submissions":"https://oj.xjtuicpc.com/submissions?problem_id=1082","statistics":"https://oj.xjtuicpc.com/problem/1082/statistics/fastest","testdata":"https://oj.xjtuicpc.com/problem/1082/testdata","discussion":"https://oj.xjtuicpc.com/discussion/problem/1082"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"JM今天过得实在是太惨了，他肥肠不爽，因此他搬出了他祖传的月亮神树。月亮神树的光辉照耀XJTUACM，每分钟都可以从所有被照射的人的手中夺取他1%的财产。JM觉得他很快就能赚得盆满钵满。然而月亮神树不久后突然失控了，不仅不把它夺来的财产交给JM，甚至开始夺取JM的财产，把JM气疯了，赶紧关闭了月亮神树。\r\n\r\n因为月亮神树没运行多久就被关掉了，所以大家并没有损失多少，迫于月亮神树的威压，并没有人去理它。可是wzk昨天刚中了彩票，赚了100000000000￥，转眼就被剥夺了很多。因为wzk太rich了，所以他的损失格外大。为了夺回财产，无敌的wzk决定消灭月亮神树。\r\n\r\n月亮神树的构造非常神奇，它的枝杈交错纵横，树上甚至存在环路，可以视为一个无向带权连通图的结构。月亮神树有一个核心节点，记为 $s$ 。要想消灭月亮神树，必须找到月亮神树的严格最不科学生成树，这是它的弱点，这样就能将其一举摧毁。\r\n\r\n定义：一个图 $G$ 的不科学生成树是 $G$ 的一棵子树，在这棵子树上，从核心节点 $s$ 到任意一个节点 $u$ 的最短路径长度，和在原图上是等长的。其中节点 $s$ 是月亮神树的核心节点。\r\n\r\n定义：一个图 $G$ 的最不科学生成树是 $G$ 的所有不科学生成树中，边权和最小的一棵树。\r\n\r\n定义：一个图 $G$ 的严格最不科学生成树是 $G$ 的所有最不科学生成树中，有序边序列的字典序最小的一棵树。\r\n\r\n定义：一个图 $G$ 的有序边序列是指，将图上所有边按编号从小到大排序后得到的编号序列。当然，子图子树也适用。\r\n\r\n现在给定月亮神树，即给定一个 $n$ 个点 $m$ 条边的无向带权连通图，点的编号为 $1, 2, ..., n$ ，边的编号为 $1, 2, ..., m$ ，给定核心节点的编号 $s$ ，求其严格最不科学生成树。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行三个正整数 $n,\\ m,\\ s$ 。\r\n\r\n接下来 $m$ 行，第 $i$ 行三个正整数 $u,\\ v,\\ w$ ，表示编号为 $i$ 的边。\r\n\r\n输入保证图是连通的，保证图上不含重边和自环。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"第一行两个正整数 $cnt$ 和 $sum$ ，用空格隔开，其中 $cnt$ 表示严格最不科学生成树的边的个数， $sum$ 表示严格最不科学生成树的边权和。\r\n\r\n接下来一行 $cnt$ 个正整数，用空格隔开，为树上所有边的编号，按编号从小到大输出。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入1\r\n```plain\r\n3 3 3\r\n1 2 1\r\n2 3 1\r\n1 3 2\r\n```\r\n\r\n#### 样例输出1\r\n```plain\r\n2 2\r\n1 2\r\n```\r\n\r\n#### 样例输入2\r\n```plain\r\n4 4 4\r\n2 3 1\r\n1 2 1\r\n3 4 1\r\n4 1 2\r\n```\r\n\r\n#### 样例输出2\r\n```plain\r\n3 4\r\n1 3 4\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"$1 \\le n,\\ m \\le 3 \\cdot 10^5$\r\n\r\n$1 \\le w_i \\le 10^9$"}]}