{"title":"czq的贸易帝国","time_limit":5000,"memory_limit":512,"tags":["2020小学期"],"operation":{"submit":"https://oj.xjtuicpc.com/problem/1214#submit_code","submissions":"https://oj.xjtuicpc.com/submissions?problem_id=1214","statistics":"https://oj.xjtuicpc.com/problem/1214/statistics/fastest","testdata":"https://oj.xjtuicpc.com/problem/1214/testdata","discussion":"https://oj.xjtuicpc.com/discussion/problem/1214"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"czq的贸易帝国由$n$个省份组成，它们由$n-1$条无向商路互相直接或间接地联通，商路有权值$w_{ij}$。\r\n\r\n初始时，czq的贸易本埠$k$在1号省份，每个省份的贸易价值$x_i$均为0。在接下来$q$月，每月都会发生一种事件：\r\n\r\n```1 x y```：czq在$x$号省份种田，使得它的贸易价值增加了$y$。\r\n\r\n```2 x```：czq把他的贸易本埠迁移到了$x$号省份。\r\n\r\nczq的商人们会把所有省份的贸易价值导向他的贸易本埠，对于第$i$号省份，导入贸易本埠的贸易价值$p_i=x_i \\times w_{kj}$，其中$k$是贸易本埠，$j$为与贸易本埠直接相连且离$i$最近（距其边数最小）的那个省份。特别的，贸易本埠自身的贸易价值不计入导入价值。\r\n\r\n现在，czq想问你，每个月他贸易本埠导入的贸易价值。\r\n\r\n提示：本题标解的复杂度为严格的$O(qlogn)$。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行一个整数$n$，为省份个数。\r\n\r\n接下来$n-1$行，每行三个整数$u,v,w$，为一条商路。\r\n\r\n接下来一行一个整数$q$，为事件个数。\r\n\r\n接下来$q$行，每行一个事件，格式如上所述。\r\n"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"对于每个事件，输出一行一个整数，为导入的贸易价值。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"### 样例输入\r\n```\r\n6\r\n1 2 1\r\n2 3 2\r\n3 4 4\r\n2 5 8\r\n5 6 16\r\n5\r\n1 1 1\r\n1 3 2\r\n2 2\r\n1 5 4\r\n2 6\r\n```\r\n\r\n### 样例输出\r\n```\r\n0\r\n2\r\n5\r\n37\r\n112\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"$1 \\leq n \\leq 10^6$\r\n\r\n$1 \\leq x \\leq n$\r\n\r\n$1 \\leq y \\leq 10^5$\r\n\r\n时限5s，输入输出量较大，建议选择较快的方式。"}]}